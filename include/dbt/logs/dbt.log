[0m06:10:23.995219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8655d60dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86563aaa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8655f76110>]}


============================== 06:10:24.011413 | 279c20a7-f1e8-40a9-b502-f2dc0d30077a ==============================
[0m06:10:24.011413 [info ] [MainThread]: Running with dbt=1.7.1
[0m06:10:24.012479 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'log_format': 'default', 'quiet': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'printer_width': '80', 'profiles_dir': '/usr/local/airflow/include/dbt', 'fail_fast': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'invocation_command': 'dbt deps', 'no_print': 'None', 'static_parser': 'True', 'debug': 'False', 'use_colors': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'write_json': 'True'}
[0m06:10:24.204900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '279c20a7-f1e8-40a9-b502-f2dc0d30077a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8655fd9210>]}
[0m06:10:24.206768 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-z0irgvk8'
[0m06:10:24.207646 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:10:24.941988 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:10:24.945426 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:10:25.218651 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:10:25.240737 [info ] [MainThread]: Updating lock file in file path: /usr/local/airflow/include/dbt/package-lock.yml
[0m06:10:25.244412 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-0mu8jgq8'
[0m06:10:25.256707 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:10:25.993243 [info ] [MainThread]: Installed from version 1.1.1
[0m06:10:25.993960 [info ] [MainThread]: Up to date!
[0m06:10:25.994586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '279c20a7-f1e8-40a9-b502-f2dc0d30077a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8655f95810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8656948750>]}
[0m06:10:25.999591 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 2.1180537, "process_user_time": 4.44214, "process_kernel_time": 0.882411, "process_mem_max_rss": "114820", "process_in_blocks": "14384", "process_out_blocks": "2240"}
[0m06:10:26.000633 [debug] [MainThread]: Command `dbt deps` succeeded at 06:10:26.000383 after 2.12 seconds
[0m06:10:26.001195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8656f76b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86562ee890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f865ae23fd0>]}
[0m06:10:26.001855 [debug] [MainThread]: Flushing usage events
[0m06:35:07.930373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14b5c79390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14b9016150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14b5c7a590>]}


============================== 06:35:07.935500 | 31750942-9b4a-4ad6-b67b-c3093e6c3b84 ==============================
[0m06:35:07.935500 [info ] [MainThread]: Running with dbt=1.7.1
[0m06:35:07.936247 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'debug': 'False', 'log_cache_events': 'False', 'warn_error': 'None', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_colors': 'True', 'partial_parse': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'log_format': 'default', 'printer_width': '80', 'fail_fast': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'indirect_selection': 'eager'}
[0m06:35:08.820644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31750942-9b4a-4ad6-b67b-c3093e6c3b84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14b3f04d90>]}
[0m06:35:08.936558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '31750942-9b4a-4ad6-b67b-c3093e6c3b84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14b5c81b90>]}
[0m06:35:08.937899 [info ] [MainThread]: Registered adapter: bigquery=1.7.1
[0m06:35:08.967313 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m06:35:08.968217 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:35:08.968808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '31750942-9b4a-4ad6-b67b-c3093e6c3b84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14b3d4cdd0>]}
[0m06:35:10.765450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31750942-9b4a-4ad6-b67b-c3093e6c3b84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14b3a6b510>]}
[0m06:35:10.782698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31750942-9b4a-4ad6-b67b-c3093e6c3b84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14b3a97650>]}
[0m06:35:10.783504 [info ] [MainThread]: Found 1 model, 2 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m06:35:10.784227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31750942-9b4a-4ad6-b67b-c3093e6c3b84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14b9e022d0>]}
[0m06:35:10.786449 [info ] [MainThread]: 
[0m06:35:10.788082 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m06:35:10.789971 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pokemon-403919'
[0m06:35:10.790709 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:35:11.518236 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pokemon-403919, now list_pokemon-403919_pokemon)
[0m06:35:11.519451 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:35:12.153697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31750942-9b4a-4ad6-b67b-c3093e6c3b84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14b3db1610>]}
[0m06:35:12.154861 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:35:12.155569 [info ] [MainThread]: 
[0m06:35:12.165084 [debug] [Thread-1 (]: Began running node model.pokemon.dim_type
[0m06:35:12.166115 [info ] [Thread-1 (]: 1 of 1 START sql table model pokemon.dim_type .................................. [RUN]
[0m06:35:12.167399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pokemon-403919_pokemon, now model.pokemon.dim_type)
[0m06:35:12.168199 [debug] [Thread-1 (]: Began compiling node model.pokemon.dim_type
[0m06:35:12.180734 [debug] [Thread-1 (]: Writing injected SQL for node "model.pokemon.dim_type"
[0m06:35:12.183282 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_type (compile): 06:35:12.168742 => 06:35:12.182810
[0m06:35:12.183961 [debug] [Thread-1 (]: Began executing node model.pokemon.dim_type
[0m06:35:12.252255 [debug] [Thread-1 (]: Writing runtime sql for node "model.pokemon.dim_type"
[0m06:35:12.255911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:35:12.258539 [debug] [Thread-1 (]: On model.pokemon.dim_type: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "pokemon", "target_name": "dev", "node_id": "model.pokemon.dim_type"} */

  
    

    create or replace table `pokemon-403919`.`pokemon`.`dim_type`
      
    
    

    OPTIONS()
    as (
      WITH type_cte AS(
    SELECT DISTINCT
        to_hex(md5(cast(coalesce(cast(type1 as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(type2 as string), '_dbt_utils_surrogate_key_null_') as string))) AS dim_type_key,
        type1 AS primary_type,
        type2 AS secondary_type
)
SELECT *
FROM type_cte
    );
  
[0m06:35:13.047801 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pokemon-403919&j=bq:US:ecb35cad-3d07-40a1-8920-73a14fa6d0e9&page=queryresults
[0m06:35:13.049858 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "pokemon", "target_name": "dev", "node_id": "model.pokemon.dim_type"} */

  
    

    create or replace table `pokemon-403919`.`pokemon`.`dim_type`
      
    
    

    OPTIONS()
    as (
      WITH type_cte AS(
    SELECT DISTINCT
        to_hex(md5(cast(coalesce(cast(type1 as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(type2 as string), '_dbt_utils_surrogate_key_null_') as string))) AS dim_type_key,
        type1 AS primary_type,
        type2 AS secondary_type
)
SELECT *
FROM type_cte
    );
  
[0m06:35:13.050671 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Dataset pokemon-403919:pokemon was not found in location US

Location: US
Job ID: ecb35cad-3d07-40a1-8920-73a14fa6d0e9

[0m06:35:13.051525 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_type (execute): 06:35:12.184399 => 06:35:13.051212
[0m06:35:13.063496 [debug] [Thread-1 (]: Runtime Error in model dim_type (models/transform/dim_type.sql)
  404 Not found: Dataset pokemon-403919:pokemon was not found in location US
  
  Location: US
  Job ID: ecb35cad-3d07-40a1-8920-73a14fa6d0e9
  
[0m06:35:13.064524 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31750942-9b4a-4ad6-b67b-c3093e6c3b84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14b3a31bd0>]}
[0m06:35:13.065953 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model pokemon.dim_type ......................... [[31mERROR[0m in 0.90s]
[0m06:35:13.069562 [debug] [Thread-1 (]: Finished running node model.pokemon.dim_type
[0m06:35:13.073877 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:35:13.074685 [debug] [MainThread]: Connection 'model.pokemon.dim_type' was properly closed.
[0m06:35:13.075375 [info ] [MainThread]: 
[0m06:35:13.076047 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.29 seconds (2.29s).
[0m06:35:13.077172 [debug] [MainThread]: Command end result
[0m06:35:13.143833 [info ] [MainThread]: 
[0m06:35:13.144564 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:35:13.145091 [info ] [MainThread]: 
[0m06:35:13.145583 [error] [MainThread]:   Runtime Error in model dim_type (models/transform/dim_type.sql)
  404 Not found: Dataset pokemon-403919:pokemon was not found in location US
  
  Location: US
  Job ID: ecb35cad-3d07-40a1-8920-73a14fa6d0e9
  
[0m06:35:13.146167 [info ] [MainThread]: 
[0m06:35:13.146737 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m06:35:13.149034 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.27415, "process_user_time": 5.708019, "process_kernel_time": 0.767804, "process_mem_max_rss": "158512", "process_in_blocks": "1872", "process_out_blocks": "3416", "command_success": false}
[0m06:35:13.149844 [debug] [MainThread]: Command `dbt run` failed at 06:35:13.149662 after 5.28 seconds
[0m06:35:13.150394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14b64bca50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14b60db610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14b6225f10>]}
[0m06:35:13.150922 [debug] [MainThread]: Flushing usage events
[0m06:36:02.775385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f752d2bc710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75300f5890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f752d2bd610>]}


============================== 06:36:02.780185 | 530eeb5f-a029-40b7-a32f-d6ba9546a950 ==============================
[0m06:36:02.780185 [info ] [MainThread]: Running with dbt=1.7.1
[0m06:36:02.780952 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'log_format': 'default', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'printer_width': '80', 'warn_error': 'None', 'log_cache_events': 'False', 'write_json': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt', 'use_experimental_parser': 'False', 'introspect': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'partial_parse': 'True'}
[0m06:36:03.447022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '530eeb5f-a029-40b7-a32f-d6ba9546a950', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f752bc07b50>]}
[0m06:36:03.548634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '530eeb5f-a029-40b7-a32f-d6ba9546a950', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f752cd1efd0>]}
[0m06:36:03.549662 [info ] [MainThread]: Registered adapter: bigquery=1.7.1
[0m06:36:03.569658 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m06:36:03.584827 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m06:36:03.585776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '530eeb5f-a029-40b7-a32f-d6ba9546a950', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f752af56810>]}
[0m06:36:05.229591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '530eeb5f-a029-40b7-a32f-d6ba9546a950', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f752ab3bbd0>]}
[0m06:36:05.245242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '530eeb5f-a029-40b7-a32f-d6ba9546a950', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f752acd4850>]}
[0m06:36:05.245944 [info ] [MainThread]: Found 1 model, 2 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m06:36:05.246452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '530eeb5f-a029-40b7-a32f-d6ba9546a950', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f752ae513d0>]}
[0m06:36:05.248121 [info ] [MainThread]: 
[0m06:36:05.249264 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m06:36:05.250934 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pokemon-403919'
[0m06:36:05.251638 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:36:05.886156 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pokemon-403919, now list_pokemon-403919_pokemon)
[0m06:36:05.887396 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:36:06.511236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '530eeb5f-a029-40b7-a32f-d6ba9546a950', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f752abdabd0>]}
[0m06:36:06.512682 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:36:06.513541 [info ] [MainThread]: 
[0m06:36:06.524764 [debug] [Thread-1 (]: Began running node model.pokemon.dim_type
[0m06:36:06.525977 [info ] [Thread-1 (]: 1 of 1 START sql table model pokemon.dim_type .................................. [RUN]
[0m06:36:06.527482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pokemon-403919_pokemon, now model.pokemon.dim_type)
[0m06:36:06.528329 [debug] [Thread-1 (]: Began compiling node model.pokemon.dim_type
[0m06:36:06.543235 [debug] [Thread-1 (]: Writing injected SQL for node "model.pokemon.dim_type"
[0m06:36:06.544980 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_type (compile): 06:36:06.528840 => 06:36:06.544210
[0m06:36:06.546055 [debug] [Thread-1 (]: Began executing node model.pokemon.dim_type
[0m06:36:06.609667 [debug] [Thread-1 (]: Writing runtime sql for node "model.pokemon.dim_type"
[0m06:36:06.610790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:36:06.612948 [debug] [Thread-1 (]: On model.pokemon.dim_type: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "pokemon", "target_name": "dev", "node_id": "model.pokemon.dim_type"} */

  
    

    create or replace table `pokemon-403919`.`pokemon`.`dim_type`
      
    
    

    OPTIONS()
    as (
      WITH type_cte AS(
    SELECT DISTINCT
        to_hex(md5(cast(coalesce(cast(type1 as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(type2 as string), '_dbt_utils_surrogate_key_null_') as string))) AS dim_type_key,
        type1 AS primary_type,
        type2 AS secondary_type
)
SELECT *
FROM type_cte
    );
  
[0m06:36:07.367729 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pokemon-403919&j=bq:us-east1:bf0fa83e-b4e1-4b17-b2a8-72f67e5939c9&page=queryresults
[0m06:36:07.778240 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Query without FROM clause cannot use SELECT DISTINCT at [14:5]')
[0m06:36:08.302759 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pokemon-403919&j=bq:us-east1:702c4562-8c42-4052-b996-e429de49a517&page=queryresults
[0m06:36:08.700560 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pokemon-403919&j=bq:us-east1:702c4562-8c42-4052-b996-e429de49a517&page=queryresults
[0m06:36:08.701912 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_type (execute): 06:36:06.546585 => 06:36:08.701538
[0m06:36:08.708498 [debug] [Thread-1 (]: Database Error in model dim_type (models/transform/dim_type.sql)
  Query without FROM clause cannot use SELECT DISTINCT at [14:5]
  compiled Code at target/run/pokemon/models/transform/dim_type.sql
[0m06:36:08.709909 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '530eeb5f-a029-40b7-a32f-d6ba9546a950', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f752ab248d0>]}
[0m06:36:08.713248 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model pokemon.dim_type ......................... [[31mERROR[0m in 2.18s]
[0m06:36:08.715239 [debug] [Thread-1 (]: Finished running node model.pokemon.dim_type
[0m06:36:08.718510 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:36:08.719156 [debug] [MainThread]: Connection 'model.pokemon.dim_type' was properly closed.
[0m06:36:08.719754 [info ] [MainThread]: 
[0m06:36:08.720865 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.47 seconds (3.47s).
[0m06:36:08.722267 [debug] [MainThread]: Command end result
[0m06:36:08.735671 [info ] [MainThread]: 
[0m06:36:08.736407 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:36:08.736898 [info ] [MainThread]: 
[0m06:36:08.737411 [error] [MainThread]:   Database Error in model dim_type (models/transform/dim_type.sql)
  Query without FROM clause cannot use SELECT DISTINCT at [14:5]
  compiled Code at target/run/pokemon/models/transform/dim_type.sql
[0m06:36:08.737906 [info ] [MainThread]: 
[0m06:36:08.738580 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m06:36:08.740132 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.011683, "process_user_time": 5.175219, "process_kernel_time": 0.221939, "process_mem_max_rss": "158740", "process_out_blocks": "3408", "command_success": false, "process_in_blocks": "0"}
[0m06:36:08.741150 [debug] [MainThread]: Command `dbt run` failed at 06:36:08.740899 after 6.01 seconds
[0m06:36:08.742014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f752cd32f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f752d2bc210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7531e80890>]}
[0m06:36:08.742741 [debug] [MainThread]: Flushing usage events
[0m06:37:10.339137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa748e64750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7499db110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa74912add0>]}


============================== 06:37:10.344055 | f603d9a1-23ba-4012-9904-be0eed39af9c ==============================
[0m06:37:10.344055 [info ] [MainThread]: Running with dbt=1.7.1
[0m06:37:10.344799 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'write_json': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'static_parser': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'printer_width': '80', 'log_cache_events': 'False', 'no_print': 'None', 'fail_fast': 'False', 'quiet': 'False', 'partial_parse': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'target_path': 'None', 'introspect': 'True'}
[0m06:37:11.007857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f603d9a1-23ba-4012-9904-be0eed39af9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa74709d050>]}
[0m06:37:11.109896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f603d9a1-23ba-4012-9904-be0eed39af9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa748c88350>]}
[0m06:37:11.110931 [info ] [MainThread]: Registered adapter: bigquery=1.7.1
[0m06:37:11.130937 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m06:37:11.170408 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:37:11.171230 [debug] [MainThread]: Partial parsing: updated file: pokemon://models/transform/dim_type.sql
[0m06:37:11.358260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f603d9a1-23ba-4012-9904-be0eed39af9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa746ee8c10>]}
[0m06:37:11.382377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f603d9a1-23ba-4012-9904-be0eed39af9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa746b95210>]}
[0m06:37:11.383166 [info ] [MainThread]: Found 1 model, 2 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m06:37:11.383792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f603d9a1-23ba-4012-9904-be0eed39af9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa74cfca2d0>]}
[0m06:37:11.386141 [info ] [MainThread]: 
[0m06:37:11.388385 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m06:37:11.434976 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pokemon-403919'
[0m06:37:11.435863 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:37:12.055076 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pokemon-403919, now list_pokemon-403919_pokemon)
[0m06:37:12.056609 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:37:12.669495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f603d9a1-23ba-4012-9904-be0eed39af9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa746ff4910>]}
[0m06:37:12.670740 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:37:12.671494 [info ] [MainThread]: 
[0m06:37:12.680131 [debug] [Thread-1 (]: Began running node model.pokemon.dim_type
[0m06:37:12.681075 [info ] [Thread-1 (]: 1 of 1 START sql table model pokemon.dim_type .................................. [RUN]
[0m06:37:12.682259 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pokemon-403919_pokemon, now model.pokemon.dim_type)
[0m06:37:12.682930 [debug] [Thread-1 (]: Began compiling node model.pokemon.dim_type
[0m06:37:12.699688 [debug] [Thread-1 (]: Writing injected SQL for node "model.pokemon.dim_type"
[0m06:37:12.700710 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_type (compile): 06:37:12.683293 => 06:37:12.700392
[0m06:37:12.701258 [debug] [Thread-1 (]: Began executing node model.pokemon.dim_type
[0m06:37:12.749471 [debug] [Thread-1 (]: Writing runtime sql for node "model.pokemon.dim_type"
[0m06:37:12.750627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:37:12.752915 [debug] [Thread-1 (]: On model.pokemon.dim_type: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "pokemon", "target_name": "dev", "node_id": "model.pokemon.dim_type"} */

  
    

    create or replace table `pokemon-403919`.`pokemon`.`dim_type`
      
    
    

    OPTIONS()
    as (
      WITH type_cte AS(
    SELECT DISTINCT
        to_hex(md5(cast(coalesce(cast(type1 as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(type2 as string), '_dbt_utils_surrogate_key_null_') as string))) AS dim_type_key,
        type1 AS primary_type,
        type2 AS secondary_type
    FROM `pokemon-403919`.`pokemon`.`pokemon`
)
SELECT *
FROM type_cte
    );
  
[0m06:37:13.502780 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pokemon-403919&j=bq:us-east1:2e353ca1-2d67-40f0-8a8f-4c29e7291693&page=queryresults
[0m06:37:15.552581 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_type (execute): 06:37:12.701584 => 06:37:15.552265
[0m06:37:15.553740 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f603d9a1-23ba-4012-9904-be0eed39af9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa746c64410>]}
[0m06:37:15.554603 [info ] [Thread-1 (]: 1 of 1 OK created sql table model pokemon.dim_type ............................. [[32mCREATE TABLE (196.0 rows, 10.8 KiB processed)[0m in 2.87s]
[0m06:37:15.555723 [debug] [Thread-1 (]: Finished running node model.pokemon.dim_type
[0m06:37:15.559096 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:37:15.559787 [debug] [MainThread]: Connection 'model.pokemon.dim_type' was properly closed.
[0m06:37:15.560302 [info ] [MainThread]: 
[0m06:37:15.560855 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.17 seconds (4.17s).
[0m06:37:15.562093 [debug] [MainThread]: Command end result
[0m06:37:15.717379 [info ] [MainThread]: 
[0m06:37:15.718190 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:37:15.718809 [info ] [MainThread]: 
[0m06:37:15.719403 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:37:15.720708 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.4332724, "process_user_time": 3.840552, "process_kernel_time": 0.302405, "process_mem_max_rss": "157196", "process_out_blocks": "3408", "process_in_blocks": "0"}
[0m06:37:15.721422 [debug] [MainThread]: Command `dbt run` succeeded at 06:37:15.721223 after 5.43 seconds
[0m06:37:15.721978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7490b1750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa74ddce190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa74deac110>]}
[0m06:37:15.723222 [debug] [MainThread]: Flushing usage events
[0m07:29:33.914074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2ed7500d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2ed767ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2ed3de550>]}


============================== 07:29:33.920161 | 058b1f2d-4077-4a36-90f7-d928137f1c2d ==============================
[0m07:29:33.920161 [info ] [MainThread]: Running with dbt=1.7.1
[0m07:29:33.920993 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'log_cache_events': 'False', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt', 'log_format': 'default', 'cache_selected_only': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'printer_width': '80', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'write_json': 'True', 'target_path': 'None', 'version_check': 'True', 'fail_fast': 'False', 'debug': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/usr/local/airflow/include/dbt', 'static_parser': 'True'}
[0m07:29:34.677968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '058b1f2d-4077-4a36-90f7-d928137f1c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2eb297cd0>]}
[0m07:29:34.774212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '058b1f2d-4077-4a36-90f7-d928137f1c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2ed1bff50>]}
[0m07:29:34.775475 [info ] [MainThread]: Registered adapter: bigquery=1.7.1
[0m07:29:34.793487 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m07:29:34.859961 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m07:29:34.860732 [debug] [MainThread]: Partial parsing: added file: pokemon://models/transform/dim_move.sql
[0m07:29:35.029878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '058b1f2d-4077-4a36-90f7-d928137f1c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2eb16bf90>]}
[0m07:29:35.051988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '058b1f2d-4077-4a36-90f7-d928137f1c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2eb04f290>]}
[0m07:29:35.052688 [info ] [MainThread]: Found 2 models, 2 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m07:29:35.053190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '058b1f2d-4077-4a36-90f7-d928137f1c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2eb16b7d0>]}
[0m07:29:35.054828 [info ] [MainThread]: 
[0m07:29:35.055887 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:29:35.057392 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pokemon-403919'
[0m07:29:35.058005 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:29:35.722619 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pokemon-403919, now list_pokemon-403919_pokemon)
[0m07:29:35.723349 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:29:36.291760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '058b1f2d-4077-4a36-90f7-d928137f1c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2eb39c1d0>]}
[0m07:29:36.292857 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:29:36.293404 [info ] [MainThread]: 
[0m07:29:36.301655 [debug] [Thread-1 (]: Began running node model.pokemon.dim_move
[0m07:29:36.302783 [info ] [Thread-1 (]: 1 of 2 START sql table model pokemon.dim_move .................................. [RUN]
[0m07:29:36.304367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pokemon-403919_pokemon, now model.pokemon.dim_move)
[0m07:29:36.305064 [debug] [Thread-1 (]: Began compiling node model.pokemon.dim_move
[0m07:29:36.319514 [debug] [Thread-1 (]: Writing injected SQL for node "model.pokemon.dim_move"
[0m07:29:36.321016 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_move (compile): 07:29:36.305473 => 07:29:36.320546
[0m07:29:36.321781 [debug] [Thread-1 (]: Began executing node model.pokemon.dim_move
[0m07:29:36.376585 [debug] [Thread-1 (]: Writing runtime sql for node "model.pokemon.dim_move"
[0m07:29:36.378150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:29:36.380950 [debug] [Thread-1 (]: On model.pokemon.dim_move: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "pokemon", "target_name": "dev", "node_id": "model.pokemon.dim_move"} */

  
    

    create or replace table `pokemon-403919`.`pokemon`.`dim_move`
      
    
    

    OPTIONS()
    as (
      WITH MovesData AS (
  SELECT
    JSON_EXTRACT_ARRAY(moves, '$') AS moves_array
    FROM `pokemon-403919`.`pokemon`.`pokemon`
)
SELECT
  JSON_EXTRACT_SCALAR(move, '$.move') AS move,
  JSON_EXTRACT_SCALAR(move, '$.url') AS url,
  JSON_EXTRACT_SCALAR(move, '$.id') AS id
FROM
  MovesData,
  UNNEST(moves_array) AS move;
    );
  
[0m07:29:37.045238 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pokemon-403919&j=bq:us-east1:ab585771-052a-4296-a201-517b555fe52a&page=queryresults
[0m07:29:37.048391 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [24:30]')
[0m07:29:37.503751 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pokemon-403919&j=bq:us-east1:fe9c7112-cd35-4362-8886-27a9ae162a99&page=queryresults
[0m07:29:37.505445 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pokemon-403919&j=bq:us-east1:fe9c7112-cd35-4362-8886-27a9ae162a99&page=queryresults
[0m07:29:37.506913 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_move (execute): 07:29:36.322157 => 07:29:37.506538
[0m07:29:37.519031 [debug] [Thread-1 (]: Database Error in model dim_move (models/transform/dim_move.sql)
  Syntax error: Expected ")" but got ";" at [24:30]
  compiled Code at target/run/pokemon/models/transform/dim_move.sql
[0m07:29:37.519894 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '058b1f2d-4077-4a36-90f7-d928137f1c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2ea2ef590>]}
[0m07:29:37.520735 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model pokemon.dim_move ......................... [[31mERROR[0m in 1.22s]
[0m07:29:37.522657 [debug] [Thread-1 (]: Finished running node model.pokemon.dim_move
[0m07:29:37.523816 [debug] [Thread-1 (]: Began running node model.pokemon.dim_type
[0m07:29:37.524673 [info ] [Thread-1 (]: 2 of 2 START sql table model pokemon.dim_type .................................. [RUN]
[0m07:29:37.525722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.pokemon.dim_move, now model.pokemon.dim_type)
[0m07:29:37.526226 [debug] [Thread-1 (]: Began compiling node model.pokemon.dim_type
[0m07:29:37.671981 [debug] [Thread-1 (]: Writing injected SQL for node "model.pokemon.dim_type"
[0m07:29:37.673035 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_type (compile): 07:29:37.526551 => 07:29:37.672727
[0m07:29:37.673562 [debug] [Thread-1 (]: Began executing node model.pokemon.dim_type
[0m07:29:37.678376 [debug] [Thread-1 (]: Writing runtime sql for node "model.pokemon.dim_type"
[0m07:29:37.679544 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:29:37.681707 [debug] [Thread-1 (]: On model.pokemon.dim_type: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "pokemon", "target_name": "dev", "node_id": "model.pokemon.dim_type"} */

  
    

    create or replace table `pokemon-403919`.`pokemon`.`dim_type`
      
    
    

    OPTIONS()
    as (
      WITH type_cte AS(
    SELECT DISTINCT
        to_hex(md5(cast(coalesce(cast(type1 as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(type2 as string), '_dbt_utils_surrogate_key_null_') as string))) AS dim_type_key,
        type1 AS primary_type,
        type2 AS secondary_type
    FROM `pokemon-403919`.`pokemon`.`pokemon`
)
SELECT *
FROM type_cte
    );
  
[0m07:29:38.451909 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pokemon-403919&j=bq:us-east1:d912a13e-0934-473d-8116-e907e3f44bca&page=queryresults
[0m07:29:40.196744 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_type (execute): 07:29:37.673885 => 07:29:40.196405
[0m07:29:40.197931 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '058b1f2d-4077-4a36-90f7-d928137f1c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2eb363d50>]}
[0m07:29:40.198774 [info ] [Thread-1 (]: 2 of 2 OK created sql table model pokemon.dim_type ............................. [[32mCREATE TABLE (207.0 rows, 12.1 KiB processed)[0m in 2.67s]
[0m07:29:40.199856 [debug] [Thread-1 (]: Finished running node model.pokemon.dim_type
[0m07:29:40.202770 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:29:40.203306 [debug] [MainThread]: Connection 'model.pokemon.dim_type' was properly closed.
[0m07:29:40.203879 [info ] [MainThread]: 
[0m07:29:40.204759 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 5.15 seconds (5.15s).
[0m07:29:40.206220 [debug] [MainThread]: Command end result
[0m07:29:40.220164 [info ] [MainThread]: 
[0m07:29:40.220855 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:29:40.221474 [info ] [MainThread]: 
[0m07:29:40.222031 [error] [MainThread]:   Database Error in model dim_move (models/transform/dim_move.sql)
  Syntax error: Expected ")" but got ";" at [24:30]
  compiled Code at target/run/pokemon/models/transform/dim_move.sql
[0m07:29:40.222554 [info ] [MainThread]: 
[0m07:29:40.223265 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m07:29:40.224869 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.3574142, "process_user_time": 3.927632, "process_kernel_time": 0.701363, "process_mem_max_rss": "158048", "process_out_blocks": "3448", "command_success": false, "process_in_blocks": "0"}
[0m07:29:40.226008 [debug] [MainThread]: Command `dbt run` failed at 07:29:40.225687 after 6.36 seconds
[0m07:29:40.226719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2ed740750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2ed19b010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2ed3fdb50>]}
[0m07:29:40.227448 [debug] [MainThread]: Flushing usage events
[0m07:30:22.442607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd25d37810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd26306990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd25fb4390>]}


============================== 07:30:22.447781 | 77139e15-958b-4b5f-8e78-f04fc3ced6ee ==============================
[0m07:30:22.447781 [info ] [MainThread]: Running with dbt=1.7.1
[0m07:30:22.448510 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/usr/local/airflow/include/dbt', 'target_path': 'None', 'log_format': 'default', 'no_print': 'None', 'write_json': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'quiet': 'False', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt', 'log_cache_events': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'version_check': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'partial_parse': 'True', 'printer_width': '80'}
[0m07:30:23.026801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77139e15-958b-4b5f-8e78-f04fc3ced6ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd23e0e450>]}
[0m07:30:23.118661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '77139e15-958b-4b5f-8e78-f04fc3ced6ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd25d43f90>]}
[0m07:30:23.119658 [info ] [MainThread]: Registered adapter: bigquery=1.7.1
[0m07:30:23.135570 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m07:30:23.171581 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:30:23.172395 [debug] [MainThread]: Partial parsing: updated file: pokemon://models/transform/dim_move.sql
[0m07:30:23.364304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77139e15-958b-4b5f-8e78-f04fc3ced6ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd23b35e90>]}
[0m07:30:23.379266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77139e15-958b-4b5f-8e78-f04fc3ced6ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd22e437d0>]}
[0m07:30:23.379909 [info ] [MainThread]: Found 2 models, 2 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m07:30:23.380397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77139e15-958b-4b5f-8e78-f04fc3ced6ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd23b4c810>]}
[0m07:30:23.382149 [info ] [MainThread]: 
[0m07:30:23.383897 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:30:23.385825 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pokemon-403919'
[0m07:30:23.386579 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:30:24.016846 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pokemon-403919_pokemon'
[0m07:30:24.017804 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:30:24.600183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77139e15-958b-4b5f-8e78-f04fc3ced6ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd23d45a90>]}
[0m07:30:24.601352 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:30:24.601942 [info ] [MainThread]: 
[0m07:30:24.609787 [debug] [Thread-1 (]: Began running node model.pokemon.dim_move
[0m07:30:24.611003 [info ] [Thread-1 (]: 1 of 2 START sql table model pokemon.dim_move .................................. [RUN]
[0m07:30:24.612621 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pokemon-403919_pokemon, now model.pokemon.dim_move)
[0m07:30:24.613371 [debug] [Thread-1 (]: Began compiling node model.pokemon.dim_move
[0m07:30:24.623622 [debug] [Thread-1 (]: Writing injected SQL for node "model.pokemon.dim_move"
[0m07:30:24.624578 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_move (compile): 07:30:24.613758 => 07:30:24.624279
[0m07:30:24.625128 [debug] [Thread-1 (]: Began executing node model.pokemon.dim_move
[0m07:30:24.669500 [debug] [Thread-1 (]: Writing runtime sql for node "model.pokemon.dim_move"
[0m07:30:24.670396 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:30:24.672235 [debug] [Thread-1 (]: On model.pokemon.dim_move: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "pokemon", "target_name": "dev", "node_id": "model.pokemon.dim_move"} */

  
    

    create or replace table `pokemon-403919`.`pokemon`.`dim_move`
      
    
    

    OPTIONS()
    as (
      WITH MovesData AS (
  SELECT
    JSON_EXTRACT_ARRAY(moves, '$') AS moves_array
    FROM `pokemon-403919`.`pokemon`.`pokemon`
)
SELECT
  JSON_EXTRACT_SCALAR(move, '$.move') AS move,
  JSON_EXTRACT_SCALAR(move, '$.url') AS url,
  JSON_EXTRACT_SCALAR(move, '$.id') AS id
FROM
  MovesData,
  UNNEST(moves_array) AS move
    );
  
[0m07:30:25.372878 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pokemon-403919&j=bq:us-east1:c19004b8-0293-4113-89da-ef7286d0fa00&page=queryresults
[0m07:30:27.693594 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_move (execute): 07:30:24.625465 => 07:30:27.693249
[0m07:30:27.694660 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77139e15-958b-4b5f-8e78-f04fc3ced6ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd23cef5d0>]}
[0m07:30:27.695444 [info ] [Thread-1 (]: 1 of 2 OK created sql table model pokemon.dim_move ............................. [[32mCREATE TABLE (81.4k rows, 6.3 MiB processed)[0m in 3.08s]
[0m07:30:27.696317 [debug] [Thread-1 (]: Finished running node model.pokemon.dim_move
[0m07:30:27.697010 [debug] [Thread-1 (]: Began running node model.pokemon.dim_type
[0m07:30:27.697750 [info ] [Thread-1 (]: 2 of 2 START sql table model pokemon.dim_type .................................. [RUN]
[0m07:30:27.698684 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.pokemon.dim_move, now model.pokemon.dim_type)
[0m07:30:27.699181 [debug] [Thread-1 (]: Began compiling node model.pokemon.dim_type
[0m07:30:27.824017 [debug] [Thread-1 (]: Writing injected SQL for node "model.pokemon.dim_type"
[0m07:30:27.824933 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_type (compile): 07:30:27.699525 => 07:30:27.824635
[0m07:30:27.825483 [debug] [Thread-1 (]: Began executing node model.pokemon.dim_type
[0m07:30:27.828540 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:30:28.442409 [debug] [Thread-1 (]: Writing runtime sql for node "model.pokemon.dim_type"
[0m07:30:28.443462 [debug] [Thread-1 (]: On model.pokemon.dim_type: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "pokemon", "target_name": "dev", "node_id": "model.pokemon.dim_type"} */

  
    

    create or replace table `pokemon-403919`.`pokemon`.`dim_type`
      
    
    

    OPTIONS()
    as (
      WITH type_cte AS(
    SELECT DISTINCT
        to_hex(md5(cast(coalesce(cast(type1 as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(type2 as string), '_dbt_utils_surrogate_key_null_') as string))) AS dim_type_key,
        type1 AS primary_type,
        type2 AS secondary_type
    FROM `pokemon-403919`.`pokemon`.`pokemon`
)
SELECT *
FROM type_cte
    );
  
[0m07:30:28.831359 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pokemon-403919&j=bq:us-east1:875a5f67-df63-407a-ba6c-a466fa274f4d&page=queryresults
[0m07:30:30.563290 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_type (execute): 07:30:27.825812 => 07:30:30.562980
[0m07:30:30.564302 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77139e15-958b-4b5f-8e78-f04fc3ced6ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd240c25d0>]}
[0m07:30:30.565029 [info ] [Thread-1 (]: 2 of 2 OK created sql table model pokemon.dim_type ............................. [[32mCREATE TABLE (207.0 rows, 12.1 KiB processed)[0m in 2.87s]
[0m07:30:30.565915 [debug] [Thread-1 (]: Finished running node model.pokemon.dim_type
[0m07:30:30.568481 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:30:30.569040 [debug] [MainThread]: Connection 'list_pokemon-403919' was properly closed.
[0m07:30:30.569454 [debug] [MainThread]: Connection 'model.pokemon.dim_type' was properly closed.
[0m07:30:30.569954 [info ] [MainThread]: 
[0m07:30:30.570605 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 7.19 seconds (7.19s).
[0m07:30:30.571958 [debug] [MainThread]: Command end result
[0m07:30:30.588398 [info ] [MainThread]: 
[0m07:30:30.589227 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:30:30.589722 [info ] [MainThread]: 
[0m07:30:30.590268 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m07:30:30.591357 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.194698, "process_user_time": 3.549154, "process_kernel_time": 0.239942, "process_mem_max_rss": "157832", "process_out_blocks": "3440", "process_in_blocks": "0"}
[0m07:30:30.592037 [debug] [MainThread]: Command `dbt run` succeeded at 07:30:30.591859 after 8.20 seconds
[0m07:30:30.592518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd262d5090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd23e43f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd25e7ffd0>]}
[0m07:30:30.593019 [debug] [MainThread]: Flushing usage events
[0m07:36:02.308952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39eed50c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39ee9e2210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39eed523d0>]}


============================== 07:36:02.313930 | 69cb571b-f04b-4fd8-99af-b4b970f095da ==============================
[0m07:36:02.313930 [info ] [MainThread]: Running with dbt=1.7.1
[0m07:36:02.314661 [debug] [MainThread]: running dbt with arguments {'log_path': '/usr/local/airflow/include/dbt/logs', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt', 'log_cache_events': 'False', 'printer_width': '80', 'warn_error': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'write_json': 'True', 'partial_parse': 'True', 'target_path': 'None', 'quiet': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'cache_selected_only': 'False', 'log_format': 'default', 'version_check': 'True'}
[0m07:36:02.941321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69cb571b-f04b-4fd8-99af-b4b970f095da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39ec921250>]}
[0m07:36:03.039367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '69cb571b-f04b-4fd8-99af-b4b970f095da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39ee720150>]}
[0m07:36:03.040429 [info ] [MainThread]: Registered adapter: bigquery=1.7.1
[0m07:36:03.057767 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m07:36:03.133720 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:36:03.135145 [debug] [MainThread]: Partial parsing: updated file: pokemon://models/transform/dim_move.sql
[0m07:36:03.326503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69cb571b-f04b-4fd8-99af-b4b970f095da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39ec874ed0>]}
[0m07:36:03.342061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '69cb571b-f04b-4fd8-99af-b4b970f095da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39ec613bd0>]}
[0m07:36:03.342714 [info ] [MainThread]: Found 2 models, 2 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m07:36:03.343408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69cb571b-f04b-4fd8-99af-b4b970f095da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39ec594c10>]}
[0m07:36:03.345309 [info ] [MainThread]: 
[0m07:36:03.346596 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:36:03.348874 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pokemon-403919'
[0m07:36:03.349672 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:36:04.067152 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pokemon-403919, now list_pokemon-403919_pokemon)
[0m07:36:04.067891 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:36:04.649621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69cb571b-f04b-4fd8-99af-b4b970f095da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39ec545f90>]}
[0m07:36:04.651319 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:36:04.652236 [info ] [MainThread]: 
[0m07:36:04.662841 [debug] [Thread-1 (]: Began running node model.pokemon.dim_move
[0m07:36:04.663843 [info ] [Thread-1 (]: 1 of 2 START sql table model pokemon.dim_move .................................. [RUN]
[0m07:36:04.665187 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pokemon-403919_pokemon, now model.pokemon.dim_move)
[0m07:36:04.665875 [debug] [Thread-1 (]: Began compiling node model.pokemon.dim_move
[0m07:36:04.675698 [debug] [Thread-1 (]: Writing injected SQL for node "model.pokemon.dim_move"
[0m07:36:04.676928 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_move (compile): 07:36:04.666314 => 07:36:04.676459
[0m07:36:04.677564 [debug] [Thread-1 (]: Began executing node model.pokemon.dim_move
[0m07:36:04.694330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:36:05.329958 [debug] [Thread-1 (]: Writing runtime sql for node "model.pokemon.dim_move"
[0m07:36:05.331349 [debug] [Thread-1 (]: On model.pokemon.dim_move: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "pokemon", "target_name": "dev", "node_id": "model.pokemon.dim_move"} */

  
    

    create or replace table `pokemon-403919`.`pokemon`.`dim_move`
      
    
    

    OPTIONS()
    as (
      WITH MovesData AS (
  SELECT
    JSON_EXTRACT_ARRAY(moves, '$') AS moves_array
    FROM `pokemon-403919`.`pokemon`.`pokemon`
), move_cte(
    SELECT
    JSON_EXTRACT_SCALAR(move, '$.move') AS move,
    JSON_EXTRACT_SCALAR(move, '$.url') AS url,
    JSON_EXTRACT_SCALAR(move, '$.id') AS id
    FROM
    MovesData,
    UNNEST(moves_array) AS move
)
SELECT *
FROM move_cte
    );
  
[0m07:36:05.597974 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pokemon-403919&j=bq:us-east1:5c4e6b9b-1ee0-429b-ab68-9398d0d5bde6&page=queryresults
[0m07:36:05.599711 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword AS but got "(" at [17:12]')
[0m07:36:06.498458 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pokemon-403919&j=bq:us-east1:247b0c82-beb0-4903-8e1c-8e49986a9a6c&page=queryresults
[0m07:36:06.501854 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pokemon-403919&j=bq:us-east1:247b0c82-beb0-4903-8e1c-8e49986a9a6c&page=queryresults
[0m07:36:06.504287 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_move (execute): 07:36:04.677910 => 07:36:06.503594
[0m07:36:06.519762 [debug] [Thread-1 (]: Database Error in model dim_move (models/transform/dim_move.sql)
  Syntax error: Expected keyword AS but got "(" at [17:12]
  compiled Code at target/run/pokemon/models/transform/dim_move.sql
[0m07:36:06.521062 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69cb571b-f04b-4fd8-99af-b4b970f095da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39ec80e4d0>]}
[0m07:36:06.522317 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model pokemon.dim_move ......................... [[31mERROR[0m in 1.86s]
[0m07:36:06.524815 [debug] [Thread-1 (]: Finished running node model.pokemon.dim_move
[0m07:36:06.526824 [debug] [Thread-1 (]: Began running node model.pokemon.dim_type
[0m07:36:06.528158 [info ] [Thread-1 (]: 2 of 2 START sql table model pokemon.dim_type .................................. [RUN]
[0m07:36:06.529730 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.pokemon.dim_move, now model.pokemon.dim_type)
[0m07:36:06.530473 [debug] [Thread-1 (]: Began compiling node model.pokemon.dim_type
[0m07:36:06.660818 [debug] [Thread-1 (]: Writing injected SQL for node "model.pokemon.dim_type"
[0m07:36:06.661803 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_type (compile): 07:36:06.531067 => 07:36:06.661491
[0m07:36:06.662339 [debug] [Thread-1 (]: Began executing node model.pokemon.dim_type
[0m07:36:06.665586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:36:07.196004 [info ] [MainThread]: [33mThe bigquery adapter does not support query cancellation. Some queries may still be running![0m
[0m07:36:07.239777 [debug] [Thread-1 (]: Writing runtime sql for node "model.pokemon.dim_type"
[0m07:36:07.240689 [debug] [Thread-1 (]: On model.pokemon.dim_type: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "pokemon", "target_name": "dev", "node_id": "model.pokemon.dim_type"} */

  
    

    create or replace table `pokemon-403919`.`pokemon`.`dim_type`
      
    
    

    OPTIONS()
    as (
      WITH type_cte AS(
    SELECT DISTINCT
        to_hex(md5(cast(coalesce(cast(type1 as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(type2 as string), '_dbt_utils_surrogate_key_null_') as string))) AS dim_type_key,
        type1 AS primary_type,
        type2 AS secondary_type
    FROM `pokemon-403919`.`pokemon`.`pokemon`
)
SELECT *
FROM type_cte
    );
  
[0m07:36:07.608035 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pokemon-403919&j=bq:us-east1:fd578d3b-3747-4ed3-b338-ba2eddd01fc9&page=queryresults
[0m07:36:09.633098 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_type (execute): 07:36:06.662678 => 07:36:09.632732
[0m07:36:09.635110 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69cb571b-f04b-4fd8-99af-b4b970f095da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39ec90f650>]}
[0m07:36:09.638072 [info ] [Thread-1 (]: 2 of 2 OK created sql table model pokemon.dim_type ............................. [[32mCREATE TABLE (207.0 rows, 12.1 KiB processed)[0m in 3.11s]
[0m07:36:09.646278 [debug] [Thread-1 (]: Finished running node model.pokemon.dim_type
[0m07:36:09.647652 [info ] [MainThread]: 
[0m07:36:09.648620 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m07:36:09.649355 [info ] [MainThread]: 
[0m07:36:09.650274 [error] [MainThread]:   Database Error in model dim_move (models/transform/dim_move.sql)
  Syntax error: Expected keyword AS but got "(" at [17:12]
  compiled Code at target/run/pokemon/models/transform/dim_move.sql
[0m07:36:09.651058 [info ] [MainThread]: 
[0m07:36:09.651859 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m07:36:09.652611 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:36:09.653291 [debug] [MainThread]: Connection 'model.pokemon.dim_type' was properly closed.
[0m07:36:09.654001 [info ] [MainThread]: 
[0m07:36:09.654767 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.31 seconds (6.31s).
[0m07:36:09.655603 [error] [MainThread]: Encountered an error:

[0m07:36:09.668070 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 90, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 75, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 197, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 244, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 284, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/main.py", line 625, in run
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 474, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 435, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 359, in execute_nodes
    self.run_queue(pool)
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 291, in run_queue
    self.job_queue.join()
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/graph/queue.py", line 198, in join
    self.inner.join()
  File "/usr/local/lib/python3.11/queue.py", line 90, in join
    self.all_tasks_done.wait()
  File "/usr/local/lib/python3.11/threading.py", line 327, in wait
    waiter.acquire()
KeyboardInterrupt

[0m07:36:09.669999 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 7.4043183, "process_user_time": 3.630207, "process_kernel_time": 0.452518, "process_mem_max_rss": "161384", "process_out_blocks": "2344", "command_success": false, "process_in_blocks": "0"}
[0m07:36:09.671139 [debug] [MainThread]: Command `dbt run` failed at 07:36:09.670867 after 7.41 seconds
[0m07:36:09.671881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39f3969bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39f1a79950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39ee990190>]}
[0m07:36:09.672588 [debug] [MainThread]: Flushing usage events
[0m07:36:21.597789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1dafc9650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1d81b4e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1d7c0c350>]}


============================== 07:36:21.603182 | f46e3ffb-9b13-4ad6-9d8d-01af26a3f471 ==============================
[0m07:36:21.603182 [info ] [MainThread]: Running with dbt=1.7.1
[0m07:36:21.604042 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'log_format': 'default', 'target_path': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'version_check': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error': 'None', 'static_parser': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'log_path': '/usr/local/airflow/include/dbt/logs'}
[0m07:36:22.191606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f46e3ffb-9b13-4ad6-9d8d-01af26a3f471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1d5e351d0>]}
[0m07:36:22.282741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f46e3ffb-9b13-4ad6-9d8d-01af26a3f471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1d7bfbe90>]}
[0m07:36:22.283709 [info ] [MainThread]: Registered adapter: bigquery=1.7.1
[0m07:36:22.299160 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m07:36:22.333815 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:36:22.334654 [debug] [MainThread]: Partial parsing: updated file: pokemon://models/transform/dim_move.sql
[0m07:36:22.502757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f46e3ffb-9b13-4ad6-9d8d-01af26a3f471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1d5cfc350>]}
[0m07:36:22.517047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f46e3ffb-9b13-4ad6-9d8d-01af26a3f471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1d5a1f850>]}
[0m07:36:22.517736 [info ] [MainThread]: Found 2 models, 2 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m07:36:22.518281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f46e3ffb-9b13-4ad6-9d8d-01af26a3f471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1d5a32f50>]}
[0m07:36:22.519923 [info ] [MainThread]: 
[0m07:36:22.520938 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:36:22.522583 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pokemon-403919'
[0m07:36:22.523219 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:36:23.114458 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pokemon-403919, now list_pokemon-403919_pokemon)
[0m07:36:23.115163 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:36:23.728499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f46e3ffb-9b13-4ad6-9d8d-01af26a3f471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1d5c1a790>]}
[0m07:36:23.729980 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:36:23.730765 [info ] [MainThread]: 
[0m07:36:23.741086 [debug] [Thread-1 (]: Began running node model.pokemon.dim_move
[0m07:36:23.742092 [info ] [Thread-1 (]: 1 of 2 START sql table model pokemon.dim_move .................................. [RUN]
[0m07:36:23.743389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pokemon-403919_pokemon, now model.pokemon.dim_move)
[0m07:36:23.744148 [debug] [Thread-1 (]: Began compiling node model.pokemon.dim_move
[0m07:36:23.761897 [debug] [Thread-1 (]: Writing injected SQL for node "model.pokemon.dim_move"
[0m07:36:23.763169 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_move (compile): 07:36:23.744602 => 07:36:23.762732
[0m07:36:23.763845 [debug] [Thread-1 (]: Began executing node model.pokemon.dim_move
[0m07:36:23.785806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:36:24.436946 [debug] [Thread-1 (]: Writing runtime sql for node "model.pokemon.dim_move"
[0m07:36:24.438026 [debug] [Thread-1 (]: On model.pokemon.dim_move: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "pokemon", "target_name": "dev", "node_id": "model.pokemon.dim_move"} */

  
    

    create or replace table `pokemon-403919`.`pokemon`.`dim_move`
      
    
    

    OPTIONS()
    as (
      WITH MovesData AS (
  SELECT
    JSON_EXTRACT_ARRAY(moves, '$') AS moves_array
    FROM `pokemon-403919`.`pokemon`.`pokemon`
), 
move_cte AS(
    SELECT
    JSON_EXTRACT_SCALAR(move, '$.move') AS move,
    JSON_EXTRACT_SCALAR(move, '$.url') AS url,
    JSON_EXTRACT_SCALAR(move, '$.id') AS id
    FROM
    MovesData,
    UNNEST(moves_array) AS move
)
SELECT 
     to_hex(md5(cast(coalesce(cast(move as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(url as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(id as string), '_dbt_utils_surrogate_key_null_') as string))) AS dim_move_key,
    move,
    url,
    id
    FROM move_cte
    );
  
[0m07:36:24.796854 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pokemon-403919&j=bq:us-east1:9e6c5a6b-5697-49c7-ae85-28b4478c3655&page=queryresults
[0m07:36:27.765072 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_move (execute): 07:36:23.764321 => 07:36:27.764783
[0m07:36:27.766213 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f46e3ffb-9b13-4ad6-9d8d-01af26a3f471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1d5bc7390>]}
[0m07:36:27.766956 [info ] [Thread-1 (]: 1 of 2 OK created sql table model pokemon.dim_move ............................. [[32mCREATE TABLE (81.4k rows, 6.3 MiB processed)[0m in 4.02s]
[0m07:36:27.768124 [debug] [Thread-1 (]: Finished running node model.pokemon.dim_move
[0m07:36:27.768882 [debug] [Thread-1 (]: Began running node model.pokemon.dim_type
[0m07:36:27.769653 [info ] [Thread-1 (]: 2 of 2 START sql table model pokemon.dim_type .................................. [RUN]
[0m07:36:27.770614 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.pokemon.dim_move, now model.pokemon.dim_type)
[0m07:36:27.771136 [debug] [Thread-1 (]: Began compiling node model.pokemon.dim_type
[0m07:36:27.777266 [debug] [Thread-1 (]: Writing injected SQL for node "model.pokemon.dim_type"
[0m07:36:27.778494 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_type (compile): 07:36:27.771501 => 07:36:27.778078
[0m07:36:27.779104 [debug] [Thread-1 (]: Began executing node model.pokemon.dim_type
[0m07:36:27.782507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:36:28.365434 [debug] [Thread-1 (]: Writing runtime sql for node "model.pokemon.dim_type"
[0m07:36:28.366596 [debug] [Thread-1 (]: On model.pokemon.dim_type: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "pokemon", "target_name": "dev", "node_id": "model.pokemon.dim_type"} */

  
    

    create or replace table `pokemon-403919`.`pokemon`.`dim_type`
      
    
    

    OPTIONS()
    as (
      WITH type_cte AS(
    SELECT DISTINCT
        to_hex(md5(cast(coalesce(cast(type1 as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(type2 as string), '_dbt_utils_surrogate_key_null_') as string))) AS dim_type_key,
        type1 AS primary_type,
        type2 AS secondary_type
    FROM `pokemon-403919`.`pokemon`.`pokemon`
)
SELECT *
FROM type_cte
    );
  
[0m07:36:28.770150 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pokemon-403919&j=bq:us-east1:8a91d22a-8667-4f65-97a5-04e4d50bd583&page=queryresults
[0m07:36:30.729441 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_type (execute): 07:36:27.779489 => 07:36:30.729127
[0m07:36:30.730754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f46e3ffb-9b13-4ad6-9d8d-01af26a3f471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1d7bec650>]}
[0m07:36:30.731724 [info ] [Thread-1 (]: 2 of 2 OK created sql table model pokemon.dim_type ............................. [[32mCREATE TABLE (207.0 rows, 12.1 KiB processed)[0m in 2.96s]
[0m07:36:30.732675 [debug] [Thread-1 (]: Finished running node model.pokemon.dim_type
[0m07:36:30.735342 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:36:30.735885 [debug] [MainThread]: Connection 'model.pokemon.dim_type' was properly closed.
[0m07:36:30.736409 [info ] [MainThread]: 
[0m07:36:30.736942 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 8.22 seconds (8.22s).
[0m07:36:30.738099 [debug] [MainThread]: Command end result
[0m07:36:30.752331 [info ] [MainThread]: 
[0m07:36:30.753116 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:36:30.753717 [info ] [MainThread]: 
[0m07:36:30.754304 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m07:36:30.755367 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.204983, "process_user_time": 3.552136, "process_kernel_time": 0.17204, "process_mem_max_rss": "157352", "process_out_blocks": "3432", "process_in_blocks": "0"}
[0m07:36:30.756020 [debug] [MainThread]: Command `dbt run` succeeded at 07:36:30.755849 after 9.21 seconds
[0m07:36:30.756608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1d7bcd410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1d7bcfc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1dcd18a50>]}
[0m07:36:30.757104 [debug] [MainThread]: Flushing usage events
[0m07:37:41.937351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb078f6c090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb07947c450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb07906aad0>]}


============================== 07:37:41.942451 | cf25d8a4-32ef-4d3d-89bc-bd8b4f8625f2 ==============================
[0m07:37:41.942451 [info ] [MainThread]: Running with dbt=1.7.1
[0m07:37:41.943289 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'printer_width': '80', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'quiet': 'False', 'log_cache_events': 'False', 'log_format': 'default', 'log_path': '/usr/local/airflow/include/dbt/logs', 'introspect': 'True', 'static_parser': 'True', 'use_colors': 'True', 'version_check': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt', 'no_print': 'None', 'debug': 'False'}
[0m07:37:42.523283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf25d8a4-32ef-4d3d-89bc-bd8b4f8625f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb076e13290>]}
[0m07:37:42.615261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf25d8a4-32ef-4d3d-89bc-bd8b4f8625f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb078c30350>]}
[0m07:37:42.616317 [info ] [MainThread]: Registered adapter: bigquery=1.7.1
[0m07:37:42.634209 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m07:37:42.671394 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:37:42.672229 [debug] [MainThread]: Partial parsing: updated file: pokemon://models/transform/dim_move.sql
[0m07:37:42.855711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf25d8a4-32ef-4d3d-89bc-bd8b4f8625f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb076c70f50>]}
[0m07:37:42.869089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf25d8a4-32ef-4d3d-89bc-bd8b4f8625f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb076a52c90>]}
[0m07:37:42.869699 [info ] [MainThread]: Found 2 models, 2 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m07:37:42.870181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf25d8a4-32ef-4d3d-89bc-bd8b4f8625f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb076ebd510>]}
[0m07:37:42.871771 [info ] [MainThread]: 
[0m07:37:42.872752 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:37:42.874399 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pokemon-403919'
[0m07:37:42.875031 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:37:43.484365 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pokemon-403919, now list_pokemon-403919_pokemon)
[0m07:37:43.485251 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:37:44.067001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf25d8a4-32ef-4d3d-89bc-bd8b4f8625f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb076a7c090>]}
[0m07:37:44.068472 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:37:44.069146 [info ] [MainThread]: 
[0m07:37:44.077274 [debug] [Thread-1 (]: Began running node model.pokemon.dim_move
[0m07:37:44.078218 [info ] [Thread-1 (]: 1 of 2 START sql table model pokemon.dim_move .................................. [RUN]
[0m07:37:44.079505 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pokemon-403919_pokemon, now model.pokemon.dim_move)
[0m07:37:44.080117 [debug] [Thread-1 (]: Began compiling node model.pokemon.dim_move
[0m07:37:44.091972 [debug] [Thread-1 (]: Writing injected SQL for node "model.pokemon.dim_move"
[0m07:37:44.092993 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_move (compile): 07:37:44.080470 => 07:37:44.092660
[0m07:37:44.093563 [debug] [Thread-1 (]: Began executing node model.pokemon.dim_move
[0m07:37:44.109808 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:37:44.746425 [debug] [Thread-1 (]: Writing runtime sql for node "model.pokemon.dim_move"
[0m07:37:44.747413 [debug] [Thread-1 (]: On model.pokemon.dim_move: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "pokemon", "target_name": "dev", "node_id": "model.pokemon.dim_move"} */

  
    

    create or replace table `pokemon-403919`.`pokemon`.`dim_move`
      
    
    

    OPTIONS()
    as (
      WITH MovesData AS (
  SELECT
    JSON_EXTRACT_ARRAY(moves, '$') AS moves_array
    FROM `pokemon-403919`.`pokemon`.`pokemon`
), 
move_cte AS(
    SELECT
    JSON_EXTRACT_SCALAR(move, '$.move') AS move,
    JSON_EXTRACT_SCALAR(move, '$.url') AS url,
    JSON_EXTRACT_SCALAR(move, '$.id') AS id
    FROM
    MovesData,
    UNNEST(moves_array) AS move
)
SELECT DISTINCT
     to_hex(md5(cast(coalesce(cast(move as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(url as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(id as string), '_dbt_utils_surrogate_key_null_') as string))) AS dim_move_key,
    move,
    url,
    id
    FROM move_cte
    );
  
[0m07:37:45.141168 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pokemon-403919&j=bq:us-east1:1040f40c-1794-4b86-a44e-94533da24c4d&page=queryresults
[0m07:37:47.514495 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_move (execute): 07:37:44.093889 => 07:37:47.514188
[0m07:37:47.515598 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf25d8a4-32ef-4d3d-89bc-bd8b4f8625f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb076a7c410>]}
[0m07:37:47.516461 [info ] [Thread-1 (]: 1 of 2 OK created sql table model pokemon.dim_move ............................. [[32mCREATE TABLE (783.0 rows, 6.3 MiB processed)[0m in 3.44s]
[0m07:37:47.517703 [debug] [Thread-1 (]: Finished running node model.pokemon.dim_move
[0m07:37:47.518617 [debug] [Thread-1 (]: Began running node model.pokemon.dim_type
[0m07:37:47.519427 [info ] [Thread-1 (]: 2 of 2 START sql table model pokemon.dim_type .................................. [RUN]
[0m07:37:47.520380 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.pokemon.dim_move, now model.pokemon.dim_type)
[0m07:37:47.520868 [debug] [Thread-1 (]: Began compiling node model.pokemon.dim_type
[0m07:37:47.526783 [debug] [Thread-1 (]: Writing injected SQL for node "model.pokemon.dim_type"
[0m07:37:47.527810 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_type (compile): 07:37:47.521188 => 07:37:47.527479
[0m07:37:47.528368 [debug] [Thread-1 (]: Began executing node model.pokemon.dim_type
[0m07:37:47.531411 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:37:48.152735 [debug] [Thread-1 (]: Writing runtime sql for node "model.pokemon.dim_type"
[0m07:37:48.153851 [debug] [Thread-1 (]: On model.pokemon.dim_type: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "pokemon", "target_name": "dev", "node_id": "model.pokemon.dim_type"} */

  
    

    create or replace table `pokemon-403919`.`pokemon`.`dim_type`
      
    
    

    OPTIONS()
    as (
      WITH type_cte AS(
    SELECT DISTINCT
        to_hex(md5(cast(coalesce(cast(type1 as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(type2 as string), '_dbt_utils_surrogate_key_null_') as string))) AS dim_type_key,
        type1 AS primary_type,
        type2 AS secondary_type
    FROM `pokemon-403919`.`pokemon`.`pokemon`
)
SELECT *
FROM type_cte
    );
  
[0m07:37:48.488072 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pokemon-403919&j=bq:us-east1:724edc6e-bf10-4afa-ba68-53e352eeb3dd&page=queryresults
[0m07:37:50.437651 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_type (execute): 07:37:47.528713 => 07:37:50.437277
[0m07:37:50.438970 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf25d8a4-32ef-4d3d-89bc-bd8b4f8625f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb076a2f810>]}
[0m07:37:50.439932 [info ] [Thread-1 (]: 2 of 2 OK created sql table model pokemon.dim_type ............................. [[32mCREATE TABLE (207.0 rows, 12.1 KiB processed)[0m in 2.92s]
[0m07:37:50.441080 [debug] [Thread-1 (]: Finished running node model.pokemon.dim_type
[0m07:37:50.444446 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:37:50.445123 [debug] [MainThread]: Connection 'model.pokemon.dim_type' was properly closed.
[0m07:37:50.445800 [info ] [MainThread]: 
[0m07:37:50.446461 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 7.57 seconds (7.57s).
[0m07:37:50.448110 [debug] [MainThread]: Command end result
[0m07:37:50.461959 [info ] [MainThread]: 
[0m07:37:50.462577 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:37:50.463152 [info ] [MainThread]: 
[0m07:37:50.463659 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m07:37:50.464636 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.595554, "process_user_time": 3.564966, "process_kernel_time": 0.170237, "process_mem_max_rss": "156056", "process_out_blocks": "3440", "process_in_blocks": "0"}
[0m07:37:50.465267 [debug] [MainThread]: Command `dbt run` succeeded at 07:37:50.465099 after 8.60 seconds
[0m07:37:50.465742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb078bf81d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb079084e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb07dd73b90>]}
[0m07:37:50.466255 [debug] [MainThread]: Flushing usage events
[0m07:56:17.253287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cacdcc6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cad640810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cad1ca3d0>]}


============================== 07:56:17.258298 | 570e938b-1264-4981-a790-142044215040 ==============================
[0m07:56:17.258298 [info ] [MainThread]: Running with dbt=1.7.1
[0m07:56:17.259166 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt', 'debug': 'False', 'partial_parse': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'use_colors': 'True', 'target_path': 'None', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error': 'None', 'indirect_selection': 'eager', 'profiles_dir': '/usr/local/airflow/include/dbt', 'write_json': 'True', 'log_format': 'default'}
[0m07:56:17.844765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '570e938b-1264-4981-a790-142044215040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8caad16a50>]}
[0m07:56:17.934801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '570e938b-1264-4981-a790-142044215040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cac9781d0>]}
[0m07:56:17.935716 [info ] [MainThread]: Registered adapter: bigquery=1.7.1
[0m07:56:17.951189 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m07:56:17.990929 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:56:17.991796 [debug] [MainThread]: Partial parsing: updated file: pokemon://models/transform/dim_move.sql
[0m07:56:18.180577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '570e938b-1264-4981-a790-142044215040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8caa91d510>]}
[0m07:56:18.196234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '570e938b-1264-4981-a790-142044215040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8caaa29d50>]}
[0m07:56:18.196888 [info ] [MainThread]: Found 2 models, 2 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m07:56:18.197499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '570e938b-1264-4981-a790-142044215040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cb0b22690>]}
[0m07:56:18.199407 [info ] [MainThread]: 
[0m07:56:18.200654 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:56:18.202407 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pokemon-403919'
[0m07:56:18.203198 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:56:18.909313 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pokemon-403919, now list_pokemon-403919_pokemon)
[0m07:56:18.910169 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:56:19.496091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '570e938b-1264-4981-a790-142044215040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8caabe8350>]}
[0m07:56:19.497643 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:56:19.498574 [info ] [MainThread]: 
[0m07:56:19.509799 [debug] [Thread-1 (]: Began running node model.pokemon.dim_move
[0m07:56:19.510805 [info ] [Thread-1 (]: 1 of 2 START sql table model pokemon.dim_move .................................. [RUN]
[0m07:56:19.512045 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pokemon-403919_pokemon, now model.pokemon.dim_move)
[0m07:56:19.512663 [debug] [Thread-1 (]: Began compiling node model.pokemon.dim_move
[0m07:56:19.523834 [debug] [Thread-1 (]: Writing injected SQL for node "model.pokemon.dim_move"
[0m07:56:19.524915 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_move (compile): 07:56:19.513026 => 07:56:19.524599
[0m07:56:19.525449 [debug] [Thread-1 (]: Began executing node model.pokemon.dim_move
[0m07:56:19.541048 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:56:20.165249 [debug] [Thread-1 (]: Writing runtime sql for node "model.pokemon.dim_move"
[0m07:56:20.166159 [debug] [Thread-1 (]: On model.pokemon.dim_move: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "pokemon", "target_name": "dev", "node_id": "model.pokemon.dim_move"} */

  
    

    create or replace table `pokemon-403919`.`pokemon`.`dim_move`
      
    
    

    OPTIONS()
    as (
      WITH MovesData AS (
  SELECT
    id ,
    JSON_EXTRACT_ARRAY(moves, '$') AS moves_array
    FROM `pokemon-403919`.`pokemon`.`pokemon`
), 
move_cte AS(
    SELECT
    id AS pokemon_id,
    JSON_EXTRACT_SCALAR(move, '$.move') AS move,
    JSON_EXTRACT_SCALAR(move, '$.url') AS url,
    JSON_EXTRACT_SCALAR(move, '$.id') AS id
    FROM
    MovesData,
    UNNEST(moves_array) AS move
)
SELECT DISTINCT
     to_hex(md5(cast(coalesce(cast(pokemon_id as string), '_dbt_utils_surrogate_key_null_') as string))) AS dim_move_key,
    pokemon_id,
    move,
    url,
    id
    FROM move_cte
    );
  
[0m07:56:20.530418 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pokemon-403919&j=bq:us-east1:321593f8-51fa-4340-9525-e377a2405485&page=queryresults
[0m07:56:23.155969 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_move (execute): 07:56:19.525776 => 07:56:23.155662
[0m07:56:23.157004 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '570e938b-1264-4981-a790-142044215040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8caa7b90d0>]}
[0m07:56:23.157739 [info ] [Thread-1 (]: 1 of 2 OK created sql table model pokemon.dim_move ............................. [[32mCREATE TABLE (81.4k rows, 6.3 MiB processed)[0m in 3.65s]
[0m07:56:23.158605 [debug] [Thread-1 (]: Finished running node model.pokemon.dim_move
[0m07:56:23.159286 [debug] [Thread-1 (]: Began running node model.pokemon.dim_type
[0m07:56:23.160000 [info ] [Thread-1 (]: 2 of 2 START sql table model pokemon.dim_type .................................. [RUN]
[0m07:56:23.160898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.pokemon.dim_move, now model.pokemon.dim_type)
[0m07:56:23.161385 [debug] [Thread-1 (]: Began compiling node model.pokemon.dim_type
[0m07:56:23.259713 [debug] [Thread-1 (]: Writing injected SQL for node "model.pokemon.dim_type"
[0m07:56:23.260722 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_type (compile): 07:56:23.161712 => 07:56:23.260376
[0m07:56:23.261266 [debug] [Thread-1 (]: Began executing node model.pokemon.dim_type
[0m07:56:23.264138 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:56:23.842658 [debug] [Thread-1 (]: Writing runtime sql for node "model.pokemon.dim_type"
[0m07:56:23.844052 [debug] [Thread-1 (]: On model.pokemon.dim_type: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "pokemon", "target_name": "dev", "node_id": "model.pokemon.dim_type"} */

  
    

    create or replace table `pokemon-403919`.`pokemon`.`dim_type`
      
    
    

    OPTIONS()
    as (
      WITH type_cte AS(
    SELECT DISTINCT
        to_hex(md5(cast(coalesce(cast(type1 as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(type2 as string), '_dbt_utils_surrogate_key_null_') as string))) AS dim_type_key,
        type1 AS primary_type,
        type2 AS secondary_type
    FROM `pokemon-403919`.`pokemon`.`pokemon`
)
SELECT *
FROM type_cte
    );
  
[0m07:56:24.195089 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pokemon-403919&j=bq:us-east1:f3f96b3e-7f63-4bbe-b3ab-391ecb953ab2&page=queryresults
[0m07:56:26.197773 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_type (execute): 07:56:23.261592 => 07:56:26.197436
[0m07:56:26.198850 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '570e938b-1264-4981-a790-142044215040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8caa7caad0>]}
[0m07:56:26.199578 [info ] [Thread-1 (]: 2 of 2 OK created sql table model pokemon.dim_type ............................. [[32mCREATE TABLE (207.0 rows, 12.1 KiB processed)[0m in 3.04s]
[0m07:56:26.200462 [debug] [Thread-1 (]: Finished running node model.pokemon.dim_type
[0m07:56:26.203138 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:56:26.203621 [debug] [MainThread]: Connection 'model.pokemon.dim_type' was properly closed.
[0m07:56:26.204077 [info ] [MainThread]: 
[0m07:56:26.204591 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 8.00 seconds (8.00s).
[0m07:56:26.205677 [debug] [MainThread]: Command end result
[0m07:56:26.218177 [info ] [MainThread]: 
[0m07:56:26.218818 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:56:26.219427 [info ] [MainThread]: 
[0m07:56:26.220861 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m07:56:26.223790 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.013763, "process_user_time": 3.540663, "process_kernel_time": 0.324645, "process_mem_max_rss": "158356", "process_in_blocks": "792", "process_out_blocks": "3448"}
[0m07:56:26.224694 [debug] [MainThread]: Command `dbt run` succeeded at 07:56:26.224490 after 9.01 seconds
[0m07:56:26.225209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cac944490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cacdb9c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8caccadb50>]}
[0m07:56:26.225697 [debug] [MainThread]: Flushing usage events
[0m08:03:51.207077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc05fd31910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc05dccc690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc05d846210>]}


============================== 08:03:51.212503 | 79a87c6b-0434-4919-9a1b-fb3ec4b69907 ==============================
[0m08:03:51.212503 [info ] [MainThread]: Running with dbt=1.7.1
[0m08:03:51.213467 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'partial_parse': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'introspect': 'True', 'version_check': 'True', 'printer_width': '80', 'no_print': 'None', 'use_experimental_parser': 'False', 'target_path': 'None', 'static_parser': 'True', 'debug': 'False', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m08:03:51.882918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79a87c6b-0434-4919-9a1b-fb3ec4b69907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc05b69aa50>]}
[0m08:03:51.988752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '79a87c6b-0434-4919-9a1b-fb3ec4b69907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc05d5f8450>]}
[0m08:03:51.989847 [info ] [MainThread]: Registered adapter: bigquery=1.7.1
[0m08:03:52.005954 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m08:03:52.045162 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:03:52.045939 [debug] [MainThread]: Partial parsing: updated file: pokemon://models/transform/dim_move.sql
[0m08:03:52.243031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79a87c6b-0434-4919-9a1b-fb3ec4b69907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc05b6d7050>]}
[0m08:03:52.260263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79a87c6b-0434-4919-9a1b-fb3ec4b69907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc05b4a7d10>]}
[0m08:03:52.261092 [info ] [MainThread]: Found 2 models, 2 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m08:03:52.261786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79a87c6b-0434-4919-9a1b-fb3ec4b69907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc05b769990>]}
[0m08:03:52.263723 [info ] [MainThread]: 
[0m08:03:52.265026 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:03:52.266685 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pokemon-403919'
[0m08:03:52.267461 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:03:52.990132 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pokemon-403919, now list_pokemon-403919_pokemon)
[0m08:03:52.991467 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:03:53.671937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79a87c6b-0434-4919-9a1b-fb3ec4b69907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc05b4eed50>]}
[0m08:03:53.674820 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:03:53.685609 [info ] [MainThread]: 
[0m08:03:53.703232 [debug] [Thread-1 (]: Began running node model.pokemon.dim_move
[0m08:03:53.704850 [info ] [Thread-1 (]: 1 of 2 START sql table model pokemon.dim_move .................................. [RUN]
[0m08:03:53.706601 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pokemon-403919_pokemon, now model.pokemon.dim_move)
[0m08:03:53.707532 [debug] [Thread-1 (]: Began compiling node model.pokemon.dim_move
[0m08:03:53.734916 [debug] [Thread-1 (]: Writing injected SQL for node "model.pokemon.dim_move"
[0m08:03:53.736294 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_move (compile): 08:03:53.708042 => 08:03:53.735926
[0m08:03:53.736913 [debug] [Thread-1 (]: Began executing node model.pokemon.dim_move
[0m08:03:53.758759 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:03:54.440236 [debug] [Thread-1 (]: Writing runtime sql for node "model.pokemon.dim_move"
[0m08:03:54.441313 [debug] [Thread-1 (]: On model.pokemon.dim_move: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "pokemon", "target_name": "dev", "node_id": "model.pokemon.dim_move"} */

  
    

    create or replace table `pokemon-403919`.`pokemon`.`dim_move`
      
    
    

    OPTIONS()
    as (
      WITH MovesData AS (
  SELECT
    id ,
    JSON_EXTRACT_ARRAY(moves, '$') AS moves_array
    FROM `pokemon-403919`.`pokemon`.`pokemon`
), 
move_cte AS(
    SELECT
    id AS pokemon_id,
    JSON_EXTRACT_SCALAR(move, '$.move') AS move,
    JSON_EXTRACT_SCALAR(move, '$.url') AS url,
    JSON_EXTRACT_SCALAR(move, '$.id') AS id
    FROM
    MovesData,
    UNNEST(moves_array) AS move
)
SELECT 
     to_hex(md5(cast(coalesce(cast(pokemon_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(move as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(url as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(id as string), '_dbt_utils_surrogate_key_null_') as string))) AS dim_move_key,
    pokemon_id,
    move,
    url,
    id
    FROM move_cte
    );
  
[0m08:03:54.879672 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pokemon-403919&j=bq:us-east1:6eb83a5a-578a-455d-b7cd-38eb44b88a20&page=queryresults
[0m08:03:57.622895 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_move (execute): 08:03:53.737261 => 08:03:57.622444
[0m08:03:57.624456 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79a87c6b-0434-4919-9a1b-fb3ec4b69907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc05b6d7490>]}
[0m08:03:57.625499 [info ] [Thread-1 (]: 1 of 2 OK created sql table model pokemon.dim_move ............................. [[32mCREATE TABLE (81.4k rows, 6.3 MiB processed)[0m in 3.92s]
[0m08:03:57.626648 [debug] [Thread-1 (]: Finished running node model.pokemon.dim_move
[0m08:03:57.627609 [debug] [Thread-1 (]: Began running node model.pokemon.dim_type
[0m08:03:57.628641 [info ] [Thread-1 (]: 2 of 2 START sql table model pokemon.dim_type .................................. [RUN]
[0m08:03:57.630363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.pokemon.dim_move, now model.pokemon.dim_type)
[0m08:03:57.631073 [debug] [Thread-1 (]: Began compiling node model.pokemon.dim_type
[0m08:03:57.637669 [debug] [Thread-1 (]: Writing injected SQL for node "model.pokemon.dim_type"
[0m08:03:57.638846 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_type (compile): 08:03:57.631465 => 08:03:57.638419
[0m08:03:57.639734 [debug] [Thread-1 (]: Began executing node model.pokemon.dim_type
[0m08:03:57.643915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:03:58.246179 [debug] [Thread-1 (]: Writing runtime sql for node "model.pokemon.dim_type"
[0m08:03:58.247795 [debug] [Thread-1 (]: On model.pokemon.dim_type: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "pokemon", "target_name": "dev", "node_id": "model.pokemon.dim_type"} */

  
    

    create or replace table `pokemon-403919`.`pokemon`.`dim_type`
      
    
    

    OPTIONS()
    as (
      WITH type_cte AS(
    SELECT DISTINCT
        to_hex(md5(cast(coalesce(cast(type1 as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(type2 as string), '_dbt_utils_surrogate_key_null_') as string))) AS dim_type_key,
        type1 AS primary_type,
        type2 AS secondary_type
    FROM `pokemon-403919`.`pokemon`.`pokemon`
)
SELECT *
FROM type_cte
    );
  
[0m08:03:58.631013 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pokemon-403919&j=bq:us-east1:b2a86f9f-44ae-43d4-a271-87cfa68f521b&page=queryresults
[0m08:04:00.735602 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_type (execute): 08:03:57.640314 => 08:04:00.735275
[0m08:04:00.736904 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79a87c6b-0434-4919-9a1b-fb3ec4b69907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc05b64b950>]}
[0m08:04:00.737780 [info ] [Thread-1 (]: 2 of 2 OK created sql table model pokemon.dim_type ............................. [[32mCREATE TABLE (207.0 rows, 12.1 KiB processed)[0m in 3.11s]
[0m08:04:00.738772 [debug] [Thread-1 (]: Finished running node model.pokemon.dim_type
[0m08:04:00.742472 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:04:00.743153 [debug] [MainThread]: Connection 'model.pokemon.dim_type' was properly closed.
[0m08:04:00.743910 [info ] [MainThread]: 
[0m08:04:00.745244 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 8.48 seconds (8.48s).
[0m08:04:00.748374 [debug] [MainThread]: Command end result
[0m08:04:00.762535 [info ] [MainThread]: 
[0m08:04:00.763246 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:04:00.764454 [info ] [MainThread]: 
[0m08:04:00.765321 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m08:04:00.766793 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.609226, "process_user_time": 4.146893, "process_kernel_time": 0.34806, "process_mem_max_rss": "155688", "process_out_blocks": "3448", "process_in_blocks": "0"}
[0m08:04:00.767539 [debug] [MainThread]: Command `dbt run` succeeded at 08:04:00.767368 after 9.61 seconds
[0m08:04:00.768140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc05dc2d390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc05d8cc890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0626eb890>]}
[0m08:04:00.768613 [debug] [MainThread]: Flushing usage events
[0m08:04:51.472587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefaf3c5390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefaf3c6410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefaf696dd0>]}


============================== 08:04:51.477809 | 2d361918-a0aa-46dd-b99b-0e23dbff762a ==============================
[0m08:04:51.477809 [info ] [MainThread]: Running with dbt=1.7.1
[0m08:04:51.478537 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/usr/local/airflow/include/dbt', 'write_json': 'True', 'static_parser': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'version_check': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'introspect': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt', 'indirect_selection': 'eager', 'no_print': 'None'}
[0m08:04:52.139697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d361918-a0aa-46dd-b99b-0e23dbff762a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefad48dbd0>]}
[0m08:04:52.241365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d361918-a0aa-46dd-b99b-0e23dbff762a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefaf3ec410>]}
[0m08:04:52.242426 [info ] [MainThread]: Registered adapter: bigquery=1.7.1
[0m08:04:52.260310 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m08:04:52.304922 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:04:52.306205 [debug] [MainThread]: Partial parsing: updated file: pokemon://models/transform/dim_move.sql
[0m08:04:52.501360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d361918-a0aa-46dd-b99b-0e23dbff762a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefad503d90>]}
[0m08:04:52.514956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d361918-a0aa-46dd-b99b-0e23dbff762a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefad095d90>]}
[0m08:04:52.515566 [info ] [MainThread]: Found 2 models, 2 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m08:04:52.516050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d361918-a0aa-46dd-b99b-0e23dbff762a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefb3536350>]}
[0m08:04:52.517671 [info ] [MainThread]: 
[0m08:04:52.518659 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:04:52.520185 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pokemon-403919'
[0m08:04:52.520767 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:04:53.115894 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pokemon-403919, now list_pokemon-403919_pokemon)
[0m08:04:53.116823 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:04:53.693514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d361918-a0aa-46dd-b99b-0e23dbff762a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefad42e4d0>]}
[0m08:04:53.694640 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:04:53.695182 [info ] [MainThread]: 
[0m08:04:53.703533 [debug] [Thread-1 (]: Began running node model.pokemon.dim_move
[0m08:04:53.704471 [info ] [Thread-1 (]: 1 of 2 START sql table model pokemon.dim_move .................................. [RUN]
[0m08:04:53.705903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pokemon-403919_pokemon, now model.pokemon.dim_move)
[0m08:04:53.706865 [debug] [Thread-1 (]: Began compiling node model.pokemon.dim_move
[0m08:04:53.718411 [debug] [Thread-1 (]: Writing injected SQL for node "model.pokemon.dim_move"
[0m08:04:53.719386 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_move (compile): 08:04:53.707451 => 08:04:53.719053
[0m08:04:53.719971 [debug] [Thread-1 (]: Began executing node model.pokemon.dim_move
[0m08:04:53.736170 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:04:54.384874 [debug] [Thread-1 (]: Writing runtime sql for node "model.pokemon.dim_move"
[0m08:04:54.385928 [debug] [Thread-1 (]: On model.pokemon.dim_move: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "pokemon", "target_name": "dev", "node_id": "model.pokemon.dim_move"} */

  
    

    create or replace table `pokemon-403919`.`pokemon`.`dim_move`
      
    
    

    OPTIONS()
    as (
      WITH MovesData AS (
  SELECT
    id ,
    JSON_EXTRACT_ARRAY(moves, '$') AS moves_array
    FROM `pokemon-403919`.`pokemon`.`pokemon`
), 
move_cte AS(
    SELECT
    id AS pokemon_id,
    JSON_EXTRACT_SCALAR(move, '$.move') AS move,
    JSON_EXTRACT_SCALAR(move, '$.url') AS url,
    JSON_EXTRACT_SCALAR(move, '$.id') AS id
    FROM
    MovesData,
    UNNEST(moves_array) AS move
)
SELECT 
     to_hex(md5(cast(coalesce(cast(pokemon_id as string), '_dbt_utils_surrogate_key_null_') as string))) AS dim_move_key,
    pokemon_id,
    move,
    url,
    id
    FROM move_cte
    );
  
[0m08:04:54.776765 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pokemon-403919&j=bq:us-east1:f0c671f8-9de8-4bb7-b101-2c5cd54fc1a8&page=queryresults
[0m08:04:57.109448 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_move (execute): 08:04:53.720335 => 08:04:57.108991
[0m08:04:57.110655 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d361918-a0aa-46dd-b99b-0e23dbff762a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefad533650>]}
[0m08:04:57.111518 [info ] [Thread-1 (]: 1 of 2 OK created sql table model pokemon.dim_move ............................. [[32mCREATE TABLE (81.4k rows, 6.3 MiB processed)[0m in 3.41s]
[0m08:04:57.112427 [debug] [Thread-1 (]: Finished running node model.pokemon.dim_move
[0m08:04:57.113377 [debug] [Thread-1 (]: Began running node model.pokemon.dim_type
[0m08:04:57.114414 [info ] [Thread-1 (]: 2 of 2 START sql table model pokemon.dim_type .................................. [RUN]
[0m08:04:57.115535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.pokemon.dim_move, now model.pokemon.dim_type)
[0m08:04:57.116070 [debug] [Thread-1 (]: Began compiling node model.pokemon.dim_type
[0m08:04:57.253443 [debug] [Thread-1 (]: Writing injected SQL for node "model.pokemon.dim_type"
[0m08:04:57.254525 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_type (compile): 08:04:57.116398 => 08:04:57.254165
[0m08:04:57.255200 [debug] [Thread-1 (]: Began executing node model.pokemon.dim_type
[0m08:04:57.258580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:04:57.839807 [debug] [Thread-1 (]: Writing runtime sql for node "model.pokemon.dim_type"
[0m08:04:57.841018 [debug] [Thread-1 (]: On model.pokemon.dim_type: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "pokemon", "target_name": "dev", "node_id": "model.pokemon.dim_type"} */

  
    

    create or replace table `pokemon-403919`.`pokemon`.`dim_type`
      
    
    

    OPTIONS()
    as (
      WITH type_cte AS(
    SELECT DISTINCT
        to_hex(md5(cast(coalesce(cast(type1 as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(type2 as string), '_dbt_utils_surrogate_key_null_') as string))) AS dim_type_key,
        type1 AS primary_type,
        type2 AS secondary_type
    FROM `pokemon-403919`.`pokemon`.`pokemon`
)
SELECT *
FROM type_cte
    );
  
[0m08:04:58.225875 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pokemon-403919&j=bq:us-east1:9a7e385b-618d-4e19-855f-641dfc87675f&page=queryresults
[0m08:04:59.972468 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_type (execute): 08:04:57.255593 => 08:04:59.972161
[0m08:04:59.973817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d361918-a0aa-46dd-b99b-0e23dbff762a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefad4a0e50>]}
[0m08:04:59.974811 [info ] [Thread-1 (]: 2 of 2 OK created sql table model pokemon.dim_type ............................. [[32mCREATE TABLE (207.0 rows, 12.1 KiB processed)[0m in 2.86s]
[0m08:04:59.975822 [debug] [Thread-1 (]: Finished running node model.pokemon.dim_type
[0m08:04:59.978526 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:04:59.978990 [debug] [MainThread]: Connection 'model.pokemon.dim_type' was properly closed.
[0m08:04:59.979442 [info ] [MainThread]: 
[0m08:04:59.979965 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 7.46 seconds (7.46s).
[0m08:04:59.981094 [debug] [MainThread]: Command end result
[0m08:04:59.994586 [info ] [MainThread]: 
[0m08:04:59.995406 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:04:59.995993 [info ] [MainThread]: 
[0m08:04:59.996513 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m08:04:59.997613 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.5670595, "process_user_time": 3.624042, "process_kernel_time": 0.410457, "process_mem_max_rss": "158584", "process_out_blocks": "3440", "process_in_blocks": "0"}
[0m08:04:59.998284 [debug] [MainThread]: Command `dbt run` succeeded at 08:04:59.998115 after 8.57 seconds
[0m08:04:59.998766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefaf962e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefaf3b88d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefb44d3990>]}
[0m08:04:59.999233 [debug] [MainThread]: Flushing usage events
[0m09:07:02.805198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd666288350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6663ca5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd66628a5d0>]}


============================== 09:07:02.810364 | 69d3094f-6cd6-4458-a737-ac709e0f3a0d ==============================
[0m09:07:02.810364 [info ] [MainThread]: Running with dbt=1.7.1
[0m09:07:02.811204 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'printer_width': '80', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'quiet': 'False', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'log_format': 'default', 'target_path': 'None', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:07:03.545180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69d3094f-6cd6-4458-a737-ac709e0f3a0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6644bdfd0>]}
[0m09:07:03.637500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '69d3094f-6cd6-4458-a737-ac709e0f3a0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd666294850>]}
[0m09:07:03.638541 [info ] [MainThread]: Registered adapter: bigquery=1.7.1
[0m09:07:03.655049 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m09:07:03.713924 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m09:07:03.714642 [debug] [MainThread]: Partial parsing: added file: pokemon://models/transform/fct_pokemon.sql
[0m09:07:03.715262 [debug] [MainThread]: Partial parsing: updated file: pokemon://models/transform/dim_type.sql
[0m09:07:03.886641 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.pokemon.fct_pokemon' (models/transform/fct_pokemon.sql) depends on a node named 'dim_product' which was not found
[0m09:07:03.888440 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1283889, "process_user_time": 3.119796, "process_kernel_time": 0.689954, "process_mem_max_rss": "146520", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m09:07:03.889113 [debug] [MainThread]: Command `dbt run` failed at 09:07:03.888941 after 1.13 seconds
[0m09:07:03.889619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6666eddd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd666268b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd66b390590>]}
[0m09:07:03.890111 [debug] [MainThread]: Flushing usage events
[0m09:07:26.855312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3fa67bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3fa678a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3fa67bed0>]}


============================== 09:07:26.861083 | f0f575eb-127e-4f80-a59a-1cf9755ecdb1 ==============================
[0m09:07:26.861083 [info ] [MainThread]: Running with dbt=1.7.1
[0m09:07:26.862085 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'warn_error': 'None', 'log_format': 'default', 'indirect_selection': 'eager', 'introspect': 'True', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'target_path': 'None', 'quiet': 'False', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'log_cache_events': 'False', 'write_json': 'True', 'use_colors': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'no_print': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:07:27.480849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0f575eb-127e-4f80-a59a-1cf9755ecdb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f887ba50>]}
[0m09:07:27.569732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f0f575eb-127e-4f80-a59a-1cf9755ecdb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3fa49c390>]}
[0m09:07:27.570766 [info ] [MainThread]: Registered adapter: bigquery=1.7.1
[0m09:07:27.587461 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m09:07:27.623298 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m09:07:27.624012 [debug] [MainThread]: Partial parsing: added file: pokemon://models/transform/fct_pokemon.sql
[0m09:07:27.624534 [debug] [MainThread]: Partial parsing: updated file: pokemon://models/transform/dim_type.sql
[0m09:07:27.790138 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.pokemon.fct_pokemon' (models/transform/fct_pokemon.sql) depends on a node named 'species' which was not found
[0m09:07:27.791413 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.9890277, "process_user_time": 3.035011, "process_kernel_time": 0.190314, "process_mem_max_rss": "146256", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m09:07:27.792117 [debug] [MainThread]: Command `dbt run` failed at 09:07:27.791937 after 0.99 seconds
[0m09:07:27.792616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3fa660910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3fac1a010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3ff6c0290>]}
[0m09:07:27.793107 [debug] [MainThread]: Flushing usage events
[0m09:07:55.677903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd31a21cfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd31a229190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd31a2282d0>]}


============================== 09:07:55.684786 | b3b6e7c1-dbde-4a78-92c7-9fef378d1a0a ==============================
[0m09:07:55.684786 [info ] [MainThread]: Running with dbt=1.7.1
[0m09:07:55.685507 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'log_format': 'default', 'indirect_selection': 'eager', 'profiles_dir': '/usr/local/airflow/include/dbt', 'partial_parse': 'True', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'debug': 'False', 'cache_selected_only': 'False', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt', 'use_colors': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'write_json': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'use_experimental_parser': 'False', 'introspect': 'True', 'log_cache_events': 'False'}
[0m09:07:56.293927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3b6e7c1-dbde-4a78-92c7-9fef378d1a0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3184bd610>]}
[0m09:07:56.385561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b3b6e7c1-dbde-4a78-92c7-9fef378d1a0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd31a244b90>]}
[0m09:07:56.386532 [info ] [MainThread]: Registered adapter: bigquery=1.7.1
[0m09:07:56.402558 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m09:07:56.444091 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m09:07:56.445054 [debug] [MainThread]: Partial parsing: added file: pokemon://models/transform/fct_pokemon.sql
[0m09:07:56.448910 [debug] [MainThread]: Partial parsing: updated file: pokemon://models/transform/dim_type.sql
[0m09:07:56.636794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3b6e7c1-dbde-4a78-92c7-9fef378d1a0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3180a7cd0>]}
[0m09:07:56.655595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3b6e7c1-dbde-4a78-92c7-9fef378d1a0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3172c76d0>]}
[0m09:07:56.656255 [info ] [MainThread]: Found 3 models, 2 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m09:07:56.656775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3b6e7c1-dbde-4a78-92c7-9fef378d1a0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3181d5110>]}
[0m09:07:56.658397 [info ] [MainThread]: 
[0m09:07:56.659395 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:07:56.660922 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pokemon-403919'
[0m09:07:56.661502 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:07:57.369614 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pokemon-403919, now list_pokemon-403919_pokemon)
[0m09:07:57.370461 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:07:57.886621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3b6e7c1-dbde-4a78-92c7-9fef378d1a0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd31839bfd0>]}
[0m09:07:57.888070 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:07:57.888887 [info ] [MainThread]: 
[0m09:07:57.899955 [debug] [Thread-1 (]: Began running node model.pokemon.dim_move
[0m09:07:57.901559 [info ] [Thread-1 (]: 1 of 3 START sql table model pokemon.dim_move .................................. [RUN]
[0m09:07:57.903126 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pokemon-403919_pokemon, now model.pokemon.dim_move)
[0m09:07:57.904031 [debug] [Thread-1 (]: Began compiling node model.pokemon.dim_move
[0m09:07:57.926751 [debug] [Thread-1 (]: Writing injected SQL for node "model.pokemon.dim_move"
[0m09:07:57.928100 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_move (compile): 09:07:57.904761 => 09:07:57.927669
[0m09:07:57.928962 [debug] [Thread-1 (]: Began executing node model.pokemon.dim_move
[0m09:07:57.980317 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:07:58.630610 [debug] [Thread-1 (]: Writing runtime sql for node "model.pokemon.dim_move"
[0m09:07:58.631761 [debug] [Thread-1 (]: On model.pokemon.dim_move: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "pokemon", "target_name": "dev", "node_id": "model.pokemon.dim_move"} */

  
    

    create or replace table `pokemon-403919`.`pokemon`.`dim_move`
      
    
    

    OPTIONS()
    as (
      WITH MovesData AS (
  SELECT
    id ,
    JSON_EXTRACT_ARRAY(moves, '$') AS moves_array
    FROM `pokemon-403919`.`pokemon`.`pokemon`
), 
move_cte AS(
    SELECT
    id AS pokemon_id,
    JSON_EXTRACT_SCALAR(move, '$.move') AS move,
    JSON_EXTRACT_SCALAR(move, '$.url') AS url,
    JSON_EXTRACT_SCALAR(move, '$.id') AS id
    FROM
    MovesData,
    UNNEST(moves_array) AS move
)
SELECT 
     to_hex(md5(cast(coalesce(cast(pokemon_id as string), '_dbt_utils_surrogate_key_null_') as string))) AS dim_move_key,
    pokemon_id,
    move,
    url,
    id
    FROM move_cte
    );
  
[0m09:07:59.073118 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pokemon-403919&j=bq:us-east1:e47ac451-04e0-4c36-b1a3-d405aa134745&page=queryresults
[0m09:08:01.570982 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_move (execute): 09:07:57.929946 => 09:08:01.570684
[0m09:08:01.572047 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3b6e7c1-dbde-4a78-92c7-9fef378d1a0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd31824ec10>]}
[0m09:08:01.572854 [info ] [Thread-1 (]: 1 of 3 OK created sql table model pokemon.dim_move ............................. [[32mCREATE TABLE (81.4k rows, 6.3 MiB processed)[0m in 3.67s]
[0m09:08:01.573792 [debug] [Thread-1 (]: Finished running node model.pokemon.dim_move
[0m09:08:01.574807 [debug] [Thread-1 (]: Began running node model.pokemon.dim_type
[0m09:08:01.575566 [info ] [Thread-1 (]: 2 of 3 START sql table model pokemon.dim_type .................................. [RUN]
[0m09:08:01.576509 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.pokemon.dim_move, now model.pokemon.dim_type)
[0m09:08:01.577001 [debug] [Thread-1 (]: Began compiling node model.pokemon.dim_type
[0m09:08:01.582869 [debug] [Thread-1 (]: Writing injected SQL for node "model.pokemon.dim_type"
[0m09:08:01.584331 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_type (compile): 09:08:01.577370 => 09:08:01.583907
[0m09:08:01.584995 [debug] [Thread-1 (]: Began executing node model.pokemon.dim_type
[0m09:08:01.588338 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:08:02.205451 [debug] [Thread-1 (]: Writing runtime sql for node "model.pokemon.dim_type"
[0m09:08:02.206435 [debug] [Thread-1 (]: On model.pokemon.dim_type: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "pokemon", "target_name": "dev", "node_id": "model.pokemon.dim_type"} */

  
    

    create or replace table `pokemon-403919`.`pokemon`.`dim_type`
      
    
    

    OPTIONS()
    as (
      WITH type_cte AS(
    SELECT DISTINCT
        to_hex(md5(cast(coalesce(cast(type1 as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(type2 as string), '_dbt_utils_surrogate_key_null_') as string))) AS dim_type_key,
        id AS pokemon_id,
        type1 AS primary_type,
        type2 AS secondary_type
    FROM `pokemon-403919`.`pokemon`.`pokemon`
)
SELECT *
FROM type_cte
    );
  
[0m09:08:02.624808 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pokemon-403919&j=bq:us-east1:6ea0d65d-83da-4ec0-88b6-0fe3c34ffe41&page=queryresults
[0m09:08:04.649579 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_type (execute): 09:08:01.585342 => 09:08:04.649258
[0m09:08:04.650787 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3b6e7c1-dbde-4a78-92c7-9fef378d1a0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd318335d10>]}
[0m09:08:04.651766 [info ] [Thread-1 (]: 2 of 3 OK created sql table model pokemon.dim_type ............................. [[32mCREATE TABLE (1.1k rows, 20.7 KiB processed)[0m in 3.07s]
[0m09:08:04.652720 [debug] [Thread-1 (]: Finished running node model.pokemon.dim_type
[0m09:08:04.654163 [debug] [Thread-1 (]: Began running node model.pokemon.fct_pokemon
[0m09:08:04.655032 [info ] [Thread-1 (]: 3 of 3 START sql table model pokemon.fct_pokemon ............................... [RUN]
[0m09:08:04.656104 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.pokemon.dim_type, now model.pokemon.fct_pokemon)
[0m09:08:04.656702 [debug] [Thread-1 (]: Began compiling node model.pokemon.fct_pokemon
[0m09:08:04.661438 [debug] [Thread-1 (]: Writing injected SQL for node "model.pokemon.fct_pokemon"
[0m09:08:04.662655 [debug] [Thread-1 (]: Timing info for model.pokemon.fct_pokemon (compile): 09:08:04.657076 => 09:08:04.662311
[0m09:08:04.663294 [debug] [Thread-1 (]: Began executing node model.pokemon.fct_pokemon
[0m09:08:04.667843 [debug] [Thread-1 (]: Writing runtime sql for node "model.pokemon.fct_pokemon"
[0m09:08:04.669037 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:08:04.670875 [debug] [Thread-1 (]: On model.pokemon.fct_pokemon: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "pokemon", "target_name": "dev", "node_id": "model.pokemon.fct_pokemon"} */

  
    

    create or replace table `pokemon-403919`.`pokemon`.`fct_pokemon`
      
    
    

    OPTIONS()
    as (
      WITH fct_pokemon_cte AS (
    SELECT
        id,
        name,
        weight,
        hp + attack + defense + special_attack + special_defense + speed AS total
    FROM `pokemon-403919`.`pokemon`.`pokemon`
)
SELECT
    pi.*,
    t.dim_type_key,
    m.dim_product_key,
FROM fct_pokemon_cte pi
INNER JOIN `pokemon-403919`.`pokemon`.`dim_type` t ON t.primary_type = pi.type1 AND (t.secondary_type = pi.type2 OR (t.secondary_type IS NULL AND pi.type2 IS NULL))
INNER JOIN `pokemon-403919`.`pokemon`.`dim_move` m on m.pokemon_id = pi.id
INNER JOIN `pokemon-403919`.`pokemon`.`pokemon` s ON pi.id = s.id
    );
  
[0m09:08:05.426552 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pokemon-403919&j=bq:us-east1:452e11eb-21cb-49a9-8609-79729654c102&page=queryresults
[0m09:08:05.867142 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: special_attack at [18:33]')
[0m09:08:06.367232 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pokemon-403919&j=bq:us-east1:cd4c3001-bed3-4da7-936d-63db3c98ca6d&page=queryresults
[0m09:08:07.027982 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pokemon-403919&j=bq:us-east1:cd4c3001-bed3-4da7-936d-63db3c98ca6d&page=queryresults
[0m09:08:07.030344 [debug] [Thread-1 (]: Timing info for model.pokemon.fct_pokemon (execute): 09:08:04.663689 => 09:08:07.029615
[0m09:08:07.043543 [debug] [Thread-1 (]: Database Error in model fct_pokemon (models/transform/fct_pokemon.sql)
  Unrecognized name: special_attack at [18:33]
  compiled Code at target/run/pokemon/models/transform/fct_pokemon.sql
[0m09:08:07.044370 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3b6e7c1-dbde-4a78-92c7-9fef378d1a0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd31812cbd0>]}
[0m09:08:07.045364 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model pokemon.fct_pokemon ...................... [[31mERROR[0m in 2.39s]
[0m09:08:07.046226 [debug] [Thread-1 (]: Finished running node model.pokemon.fct_pokemon
[0m09:08:07.048988 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:08:07.049652 [debug] [MainThread]: Connection 'model.pokemon.fct_pokemon' was properly closed.
[0m09:08:07.050361 [info ] [MainThread]: 
[0m09:08:07.051339 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 10.39 seconds (10.39s).
[0m09:08:07.053081 [debug] [MainThread]: Command end result
[0m09:08:07.072985 [info ] [MainThread]: 
[0m09:08:07.073598 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:08:07.074056 [info ] [MainThread]: 
[0m09:08:07.074483 [error] [MainThread]:   Database Error in model fct_pokemon (models/transform/fct_pokemon.sql)
  Unrecognized name: special_attack at [18:33]
  compiled Code at target/run/pokemon/models/transform/fct_pokemon.sql
[0m09:08:07.074963 [info ] [MainThread]: 
[0m09:08:07.075418 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m09:08:07.076518 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 11.443427, "process_user_time": 3.715767, "process_kernel_time": 0.279681, "process_mem_max_rss": "158576", "process_out_blocks": "3488", "command_success": false, "process_in_blocks": "0"}
[0m09:08:07.077242 [debug] [MainThread]: Command `dbt run` failed at 09:08:07.077073 after 11.44 seconds
[0m09:08:07.077807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd31a21c0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd31a493790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd31f270090>]}
[0m09:08:07.078337 [debug] [MainThread]: Flushing usage events
[0m09:08:42.819598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c232e6850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c2361b110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c23742c10>]}


============================== 09:08:42.825292 | d1f6275a-1b60-4c83-a979-04f1e25e6edd ==============================
[0m09:08:42.825292 [info ] [MainThread]: Running with dbt=1.7.1
[0m09:08:42.826033 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'version_check': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt', 'indirect_selection': 'eager', 'fail_fast': 'False', 'introspect': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'debug': 'False', 'write_json': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'cache_selected_only': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'target_path': 'None', 'no_print': 'None', 'warn_error': 'None'}
[0m09:08:43.439013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1f6275a-1b60-4c83-a979-04f1e25e6edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c2363a150>]}
[0m09:08:43.533900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1f6275a-1b60-4c83-a979-04f1e25e6edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c237438d0>]}
[0m09:08:43.534912 [info ] [MainThread]: Registered adapter: bigquery=1.7.1
[0m09:08:43.552827 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m09:08:43.592060 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:08:43.592879 [debug] [MainThread]: Partial parsing: updated file: pokemon://models/transform/fct_pokemon.sql
[0m09:08:43.743670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1f6275a-1b60-4c83-a979-04f1e25e6edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c2110c910>]}
[0m09:08:43.759908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1f6275a-1b60-4c83-a979-04f1e25e6edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c21358dd0>]}
[0m09:08:43.760551 [info ] [MainThread]: Found 3 models, 2 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m09:08:43.761048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1f6275a-1b60-4c83-a979-04f1e25e6edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c213f85d0>]}
[0m09:08:43.762727 [info ] [MainThread]: 
[0m09:08:43.764060 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:08:43.765852 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pokemon-403919'
[0m09:08:43.766532 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:08:44.406886 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pokemon-403919_pokemon'
[0m09:08:44.407553 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:08:45.009479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1f6275a-1b60-4c83-a979-04f1e25e6edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c2129b090>]}
[0m09:08:45.010914 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:08:45.014106 [info ] [MainThread]: 
[0m09:08:45.043053 [debug] [Thread-1 (]: Began running node model.pokemon.dim_move
[0m09:08:45.045162 [info ] [Thread-1 (]: 1 of 3 START sql table model pokemon.dim_move .................................. [RUN]
[0m09:08:45.046574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pokemon-403919_pokemon, now model.pokemon.dim_move)
[0m09:08:45.047434 [debug] [Thread-1 (]: Began compiling node model.pokemon.dim_move
[0m09:08:45.090823 [debug] [Thread-1 (]: Writing injected SQL for node "model.pokemon.dim_move"
[0m09:08:45.091919 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_move (compile): 09:08:45.047958 => 09:08:45.091557
[0m09:08:45.092595 [debug] [Thread-1 (]: Began executing node model.pokemon.dim_move
[0m09:08:45.113765 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:08:45.775691 [debug] [Thread-1 (]: Writing runtime sql for node "model.pokemon.dim_move"
[0m09:08:45.776686 [debug] [Thread-1 (]: On model.pokemon.dim_move: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "pokemon", "target_name": "dev", "node_id": "model.pokemon.dim_move"} */

  
    

    create or replace table `pokemon-403919`.`pokemon`.`dim_move`
      
    
    

    OPTIONS()
    as (
      WITH MovesData AS (
  SELECT
    id ,
    JSON_EXTRACT_ARRAY(moves, '$') AS moves_array
    FROM `pokemon-403919`.`pokemon`.`pokemon`
), 
move_cte AS(
    SELECT
    id AS pokemon_id,
    JSON_EXTRACT_SCALAR(move, '$.move') AS move,
    JSON_EXTRACT_SCALAR(move, '$.url') AS url,
    JSON_EXTRACT_SCALAR(move, '$.id') AS id
    FROM
    MovesData,
    UNNEST(moves_array) AS move
)
SELECT 
     to_hex(md5(cast(coalesce(cast(pokemon_id as string), '_dbt_utils_surrogate_key_null_') as string))) AS dim_move_key,
    pokemon_id,
    move,
    url,
    id
    FROM move_cte
    );
  
[0m09:08:46.156253 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pokemon-403919&j=bq:us-east1:c7e83504-ceae-4a97-bd59-494c36e5c953&page=queryresults
[0m09:08:48.470585 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_move (execute): 09:08:45.092985 => 09:08:48.470277
[0m09:08:48.471659 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1f6275a-1b60-4c83-a979-04f1e25e6edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c215415d0>]}
[0m09:08:48.472440 [info ] [Thread-1 (]: 1 of 3 OK created sql table model pokemon.dim_move ............................. [[32mCREATE TABLE (81.4k rows, 6.3 MiB processed)[0m in 3.43s]
[0m09:08:48.473345 [debug] [Thread-1 (]: Finished running node model.pokemon.dim_move
[0m09:08:48.474049 [debug] [Thread-1 (]: Began running node model.pokemon.dim_type
[0m09:08:48.474811 [info ] [Thread-1 (]: 2 of 3 START sql table model pokemon.dim_type .................................. [RUN]
[0m09:08:48.475764 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.pokemon.dim_move, now model.pokemon.dim_type)
[0m09:08:48.476258 [debug] [Thread-1 (]: Began compiling node model.pokemon.dim_type
[0m09:08:48.586247 [debug] [Thread-1 (]: Writing injected SQL for node "model.pokemon.dim_type"
[0m09:08:48.589228 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_type (compile): 09:08:48.476581 => 09:08:48.588729
[0m09:08:48.589912 [debug] [Thread-1 (]: Began executing node model.pokemon.dim_type
[0m09:08:48.593966 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:08:49.192510 [debug] [Thread-1 (]: Writing runtime sql for node "model.pokemon.dim_type"
[0m09:08:49.193511 [debug] [Thread-1 (]: On model.pokemon.dim_type: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "pokemon", "target_name": "dev", "node_id": "model.pokemon.dim_type"} */

  
    

    create or replace table `pokemon-403919`.`pokemon`.`dim_type`
      
    
    

    OPTIONS()
    as (
      WITH type_cte AS(
    SELECT DISTINCT
        to_hex(md5(cast(coalesce(cast(type1 as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(type2 as string), '_dbt_utils_surrogate_key_null_') as string))) AS dim_type_key,
        id AS pokemon_id,
        type1 AS primary_type,
        type2 AS secondary_type
    FROM `pokemon-403919`.`pokemon`.`pokemon`
)
SELECT *
FROM type_cte
    );
  
[0m09:08:49.575810 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pokemon-403919&j=bq:us-east1:2147dd60-de18-4a2e-ac02-286814ceb0a2&page=queryresults
[0m09:08:51.559800 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_type (execute): 09:08:48.590367 => 09:08:51.559483
[0m09:08:51.560978 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1f6275a-1b60-4c83-a979-04f1e25e6edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c2157f790>]}
[0m09:08:51.561943 [info ] [Thread-1 (]: 2 of 3 OK created sql table model pokemon.dim_type ............................. [[32mCREATE TABLE (1.1k rows, 20.7 KiB processed)[0m in 3.09s]
[0m09:08:51.563071 [debug] [Thread-1 (]: Finished running node model.pokemon.dim_type
[0m09:08:51.565416 [debug] [Thread-1 (]: Began running node model.pokemon.fct_pokemon
[0m09:08:51.566272 [info ] [Thread-1 (]: 3 of 3 START sql table model pokemon.fct_pokemon ............................... [RUN]
[0m09:08:51.567430 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.pokemon.dim_type, now model.pokemon.fct_pokemon)
[0m09:08:51.568104 [debug] [Thread-1 (]: Began compiling node model.pokemon.fct_pokemon
[0m09:08:51.573285 [debug] [Thread-1 (]: Writing injected SQL for node "model.pokemon.fct_pokemon"
[0m09:08:51.574407 [debug] [Thread-1 (]: Timing info for model.pokemon.fct_pokemon (compile): 09:08:51.568511 => 09:08:51.574016
[0m09:08:51.574956 [debug] [Thread-1 (]: Began executing node model.pokemon.fct_pokemon
[0m09:08:51.579520 [debug] [Thread-1 (]: Writing runtime sql for node "model.pokemon.fct_pokemon"
[0m09:08:51.580432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:08:51.582173 [debug] [Thread-1 (]: On model.pokemon.fct_pokemon: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "pokemon", "target_name": "dev", "node_id": "model.pokemon.fct_pokemon"} */

  
    

    create or replace table `pokemon-403919`.`pokemon`.`fct_pokemon`
      
    
    

    OPTIONS()
    as (
      WITH fct_pokemon_cte AS (
    SELECT
        id,
        name,
        weight,
        hp + attack + defense + sp_atk + sp_def + speed AS total
    FROM `pokemon-403919`.`pokemon`.`pokemon`
)
SELECT
    pi.*,
    t.dim_type_key,
    m.dim_product_key,
FROM fct_pokemon_cte pi
INNER JOIN `pokemon-403919`.`pokemon`.`dim_type` t ON t.primary_type = pi.type1 AND (t.secondary_type = pi.type2 OR (t.secondary_type IS NULL AND pi.type2 IS NULL))
INNER JOIN `pokemon-403919`.`pokemon`.`dim_move` m on m.pokemon_id = pi.id
INNER JOIN `pokemon-403919`.`pokemon`.`pokemon` s ON pi.id = s.id
    );
  
[0m09:08:52.321387 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pokemon-403919&j=bq:us-east1:e4df2823-ccce-4571-9815-390cead63f6f&page=queryresults
[0m09:08:52.722898 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name type1 not found inside pi at [26:75]')
[0m09:08:53.534661 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pokemon-403919&j=bq:us-east1:97f0a20d-39c3-4d8b-b5b9-2aab27a2c659&page=queryresults
[0m09:08:53.936570 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pokemon-403919&j=bq:us-east1:97f0a20d-39c3-4d8b-b5b9-2aab27a2c659&page=queryresults
[0m09:08:53.938030 [debug] [Thread-1 (]: Timing info for model.pokemon.fct_pokemon (execute): 09:08:51.575316 => 09:08:53.937608
[0m09:08:53.945816 [debug] [Thread-1 (]: Database Error in model fct_pokemon (models/transform/fct_pokemon.sql)
  Name type1 not found inside pi at [26:75]
  compiled Code at target/run/pokemon/models/transform/fct_pokemon.sql
[0m09:08:53.946600 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1f6275a-1b60-4c83-a979-04f1e25e6edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c211b09d0>]}
[0m09:08:53.947359 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model pokemon.fct_pokemon ...................... [[31mERROR[0m in 2.38s]
[0m09:08:53.948157 [debug] [Thread-1 (]: Finished running node model.pokemon.fct_pokemon
[0m09:08:53.951252 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:08:53.951913 [debug] [MainThread]: Connection 'list_pokemon-403919' was properly closed.
[0m09:08:53.952360 [debug] [MainThread]: Connection 'model.pokemon.fct_pokemon' was properly closed.
[0m09:08:53.952867 [info ] [MainThread]: 
[0m09:08:53.953517 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 10.19 seconds (10.19s).
[0m09:08:53.955153 [debug] [MainThread]: Command end result
[0m09:08:53.969516 [info ] [MainThread]: 
[0m09:08:53.970435 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:08:53.970988 [info ] [MainThread]: 
[0m09:08:53.971556 [error] [MainThread]:   Database Error in model fct_pokemon (models/transform/fct_pokemon.sql)
  Name type1 not found inside pi at [26:75]
  compiled Code at target/run/pokemon/models/transform/fct_pokemon.sql
[0m09:08:53.972095 [info ] [MainThread]: 
[0m09:08:53.972749 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m09:08:53.974187 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 11.198084, "process_user_time": 3.715739, "process_kernel_time": 0.356303, "process_mem_max_rss": "160740", "process_out_blocks": "3488", "command_success": false, "process_in_blocks": "0"}
[0m09:08:53.975027 [debug] [MainThread]: Command `dbt run` failed at 09:08:53.974813 after 11.20 seconds
[0m09:08:53.975586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c232cc290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c232e75d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c238ccad0>]}
[0m09:08:53.976153 [debug] [MainThread]: Flushing usage events
[0m09:10:05.462016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceb78e8cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceb790c150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceb78eb390>]}


============================== 09:10:05.467064 | 96e74a45-22dd-4778-82ae-92e8d9aeff94 ==============================
[0m09:10:05.467064 [info ] [MainThread]: Running with dbt=1.7.1
[0m09:10:05.467858 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'log_format': 'default', 'use_colors': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'static_parser': 'True', 'warn_error': 'None', 'quiet': 'False', 'partial_parse': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt', 'use_experimental_parser': 'False', 'debug': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'cache_selected_only': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'target_path': 'None', 'fail_fast': 'False'}
[0m09:10:06.087875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96e74a45-22dd-4778-82ae-92e8d9aeff94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceb5591d50>]}
[0m09:10:06.184074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96e74a45-22dd-4778-82ae-92e8d9aeff94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceb7374c10>]}
[0m09:10:06.185232 [info ] [MainThread]: Registered adapter: bigquery=1.7.1
[0m09:10:06.201232 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m09:10:06.237581 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:10:06.238474 [debug] [MainThread]: Partial parsing: updated file: pokemon://models/transform/fct_pokemon.sql
[0m09:10:06.399593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96e74a45-22dd-4778-82ae-92e8d9aeff94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceb5452f90>]}
[0m09:10:06.414542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96e74a45-22dd-4778-82ae-92e8d9aeff94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceb5276e90>]}
[0m09:10:06.415183 [info ] [MainThread]: Found 3 models, 2 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m09:10:06.415814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96e74a45-22dd-4778-82ae-92e8d9aeff94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceb551eb90>]}
[0m09:10:06.417772 [info ] [MainThread]: 
[0m09:10:06.418883 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:10:06.420521 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pokemon-403919'
[0m09:10:06.421217 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:10:07.042507 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pokemon-403919, now list_pokemon-403919_pokemon)
[0m09:10:07.043143 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:10:07.629249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96e74a45-22dd-4778-82ae-92e8d9aeff94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceb535d5d0>]}
[0m09:10:07.630474 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:10:07.631160 [info ] [MainThread]: 
[0m09:10:07.639862 [debug] [Thread-1 (]: Began running node model.pokemon.dim_move
[0m09:10:07.640689 [info ] [Thread-1 (]: 1 of 3 START sql table model pokemon.dim_move .................................. [RUN]
[0m09:10:07.642176 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pokemon-403919_pokemon, now model.pokemon.dim_move)
[0m09:10:07.642811 [debug] [Thread-1 (]: Began compiling node model.pokemon.dim_move
[0m09:10:07.668883 [debug] [Thread-1 (]: Writing injected SQL for node "model.pokemon.dim_move"
[0m09:10:07.670195 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_move (compile): 09:10:07.643170 => 09:10:07.669769
[0m09:10:07.670851 [debug] [Thread-1 (]: Began executing node model.pokemon.dim_move
[0m09:10:07.691110 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:08.305186 [debug] [Thread-1 (]: Writing runtime sql for node "model.pokemon.dim_move"
[0m09:10:08.306162 [debug] [Thread-1 (]: On model.pokemon.dim_move: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "pokemon", "target_name": "dev", "node_id": "model.pokemon.dim_move"} */

  
    

    create or replace table `pokemon-403919`.`pokemon`.`dim_move`
      
    
    

    OPTIONS()
    as (
      WITH MovesData AS (
  SELECT
    id ,
    JSON_EXTRACT_ARRAY(moves, '$') AS moves_array
    FROM `pokemon-403919`.`pokemon`.`pokemon`
), 
move_cte AS(
    SELECT
    id AS pokemon_id,
    JSON_EXTRACT_SCALAR(move, '$.move') AS move,
    JSON_EXTRACT_SCALAR(move, '$.url') AS url,
    JSON_EXTRACT_SCALAR(move, '$.id') AS id
    FROM
    MovesData,
    UNNEST(moves_array) AS move
)
SELECT 
     to_hex(md5(cast(coalesce(cast(pokemon_id as string), '_dbt_utils_surrogate_key_null_') as string))) AS dim_move_key,
    pokemon_id,
    move,
    url,
    id
    FROM move_cte
    );
  
[0m09:10:08.673043 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pokemon-403919&j=bq:us-east1:ab91a966-37e6-4e19-85cc-8b4d0c977ed7&page=queryresults
[0m09:10:11.248711 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_move (execute): 09:10:07.671219 => 09:10:11.248379
[0m09:10:11.249886 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96e74a45-22dd-4778-82ae-92e8d9aeff94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceb51ab950>]}
[0m09:10:11.250733 [info ] [Thread-1 (]: 1 of 3 OK created sql table model pokemon.dim_move ............................. [[32mCREATE TABLE (81.4k rows, 6.3 MiB processed)[0m in 3.61s]
[0m09:10:11.251645 [debug] [Thread-1 (]: Finished running node model.pokemon.dim_move
[0m09:10:11.252376 [debug] [Thread-1 (]: Began running node model.pokemon.dim_type
[0m09:10:11.253113 [info ] [Thread-1 (]: 2 of 3 START sql table model pokemon.dim_type .................................. [RUN]
[0m09:10:11.254036 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.pokemon.dim_move, now model.pokemon.dim_type)
[0m09:10:11.254518 [debug] [Thread-1 (]: Began compiling node model.pokemon.dim_type
[0m09:10:11.360094 [debug] [Thread-1 (]: Writing injected SQL for node "model.pokemon.dim_type"
[0m09:10:11.361077 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_type (compile): 09:10:11.254836 => 09:10:11.360760
[0m09:10:11.361730 [debug] [Thread-1 (]: Began executing node model.pokemon.dim_type
[0m09:10:11.364922 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:11.979112 [debug] [Thread-1 (]: Writing runtime sql for node "model.pokemon.dim_type"
[0m09:10:11.980062 [debug] [Thread-1 (]: On model.pokemon.dim_type: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "pokemon", "target_name": "dev", "node_id": "model.pokemon.dim_type"} */

  
    

    create or replace table `pokemon-403919`.`pokemon`.`dim_type`
      
    
    

    OPTIONS()
    as (
      WITH type_cte AS(
    SELECT DISTINCT
        to_hex(md5(cast(coalesce(cast(type1 as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(type2 as string), '_dbt_utils_surrogate_key_null_') as string))) AS dim_type_key,
        id AS pokemon_id,
        type1 AS primary_type,
        type2 AS secondary_type
    FROM `pokemon-403919`.`pokemon`.`pokemon`
)
SELECT *
FROM type_cte
    );
  
[0m09:10:12.323232 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pokemon-403919&j=bq:us-east1:3506bd69-1785-4599-b50f-d05bfe774ba3&page=queryresults
[0m09:10:14.303962 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_type (execute): 09:10:11.362080 => 09:10:14.303530
[0m09:10:14.305534 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96e74a45-22dd-4778-82ae-92e8d9aeff94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceb5dfc610>]}
[0m09:10:14.306585 [info ] [Thread-1 (]: 2 of 3 OK created sql table model pokemon.dim_type ............................. [[32mCREATE TABLE (1.1k rows, 20.7 KiB processed)[0m in 3.05s]
[0m09:10:14.307522 [debug] [Thread-1 (]: Finished running node model.pokemon.dim_type
[0m09:10:14.309145 [debug] [Thread-1 (]: Began running node model.pokemon.fct_pokemon
[0m09:10:14.309747 [info ] [Thread-1 (]: 3 of 3 START sql table model pokemon.fct_pokemon ............................... [RUN]
[0m09:10:14.310761 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.pokemon.dim_type, now model.pokemon.fct_pokemon)
[0m09:10:14.311375 [debug] [Thread-1 (]: Began compiling node model.pokemon.fct_pokemon
[0m09:10:14.316055 [debug] [Thread-1 (]: Writing injected SQL for node "model.pokemon.fct_pokemon"
[0m09:10:14.317199 [debug] [Thread-1 (]: Timing info for model.pokemon.fct_pokemon (compile): 09:10:14.311754 => 09:10:14.316779
[0m09:10:14.317801 [debug] [Thread-1 (]: Began executing node model.pokemon.fct_pokemon
[0m09:10:14.321723 [debug] [Thread-1 (]: Writing runtime sql for node "model.pokemon.fct_pokemon"
[0m09:10:14.322454 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:14.324165 [debug] [Thread-1 (]: On model.pokemon.fct_pokemon: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "pokemon", "target_name": "dev", "node_id": "model.pokemon.fct_pokemon"} */

  
    

    create or replace table `pokemon-403919`.`pokemon`.`fct_pokemon`
      
    
    

    OPTIONS()
    as (
      WITH fct_pokemon_cte AS (
    SELECT
        id,
        name,
        weight,
        height,
        type1,
        type2,
        hp + attack + defense + sp_atk + sp_def + speed AS total
    FROM `pokemon-403919`.`pokemon`.`pokemon`
)
SELECT
    pi.id,
    pi.name,
    pi.weight,
    pi.height,
    t.dim_type_key,
    m.dim_product_key,
FROM fct_pokemon_cte pi
INNER JOIN `pokemon-403919`.`pokemon`.`dim_type` t ON t.primary_type = pi.type1 AND (t.secondary_type = pi.type2 OR (t.secondary_type IS NULL AND pi.type2 IS NULL))
INNER JOIN `pokemon-403919`.`pokemon`.`dim_move` m on m.pokemon_id = pi.id
INNER JOIN `pokemon-403919`.`pokemon`.`pokemon` s ON pi.id = s.id
    );
  
[0m09:10:15.044976 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pokemon-403919&j=bq:us-east1:e2b57d84-e531-4864-8570-feb1368f33be&page=queryresults
[0m09:10:15.462288 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name dim_product_key not found inside m at [30:7]')
[0m09:10:15.857123 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pokemon-403919&j=bq:us-east1:10408cc7-15eb-4cb6-a7f6-e62c407c2ed7&page=queryresults
[0m09:10:16.256261 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pokemon-403919&j=bq:us-east1:10408cc7-15eb-4cb6-a7f6-e62c407c2ed7&page=queryresults
[0m09:10:16.257402 [debug] [Thread-1 (]: Timing info for model.pokemon.fct_pokemon (execute): 09:10:14.318205 => 09:10:16.257071
[0m09:10:16.263459 [debug] [Thread-1 (]: Database Error in model fct_pokemon (models/transform/fct_pokemon.sql)
  Name dim_product_key not found inside m at [30:7]
  compiled Code at target/run/pokemon/models/transform/fct_pokemon.sql
[0m09:10:16.264242 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96e74a45-22dd-4778-82ae-92e8d9aeff94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceb5590e50>]}
[0m09:10:16.265024 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model pokemon.fct_pokemon ...................... [[31mERROR[0m in 1.95s]
[0m09:10:16.266586 [debug] [Thread-1 (]: Finished running node model.pokemon.fct_pokemon
[0m09:10:16.269305 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:10:16.269833 [debug] [MainThread]: Connection 'model.pokemon.fct_pokemon' was properly closed.
[0m09:10:16.270389 [info ] [MainThread]: 
[0m09:10:16.270903 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 9.85 seconds (9.85s).
[0m09:10:16.272353 [debug] [MainThread]: Command end result
[0m09:10:16.287227 [info ] [MainThread]: 
[0m09:10:16.287844 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:10:16.288302 [info ] [MainThread]: 
[0m09:10:16.288766 [error] [MainThread]:   Database Error in model fct_pokemon (models/transform/fct_pokemon.sql)
  Name dim_product_key not found inside m at [30:7]
  compiled Code at target/run/pokemon/models/transform/fct_pokemon.sql
[0m09:10:16.289232 [info ] [MainThread]: 
[0m09:10:16.289764 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m09:10:16.290786 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 10.876309, "process_user_time": 3.715178, "process_kernel_time": 0.220902, "process_mem_max_rss": "158860", "process_out_blocks": "3504", "command_success": false, "process_in_blocks": "0"}
[0m09:10:16.291449 [debug] [MainThread]: Command `dbt run` failed at 09:10:16.291282 after 10.88 seconds
[0m09:10:16.291952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceb78eb390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceb75c0e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceb78f9d10>]}
[0m09:10:16.292452 [debug] [MainThread]: Flushing usage events
[0m09:10:58.716053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f030ad18050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f030acebad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f030ab44d10>]}


============================== 09:10:58.720982 | 21952c9e-fe43-4e9a-a292-9f3f343a58b1 ==============================
[0m09:10:58.720982 [info ] [MainThread]: Running with dbt=1.7.1
[0m09:10:58.721785 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'write_json': 'True', 'static_parser': 'True', 'printer_width': '80', 'introspect': 'True', 'version_check': 'True', 'warn_error': 'None', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'quiet': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m09:10:59.378028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21952c9e-fe43-4e9a-a292-9f3f343a58b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0308b163d0>]}
[0m09:10:59.525589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21952c9e-fe43-4e9a-a292-9f3f343a58b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f030a8e6110>]}
[0m09:10:59.526493 [info ] [MainThread]: Registered adapter: bigquery=1.7.1
[0m09:10:59.542080 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m09:10:59.579883 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:10:59.580655 [debug] [MainThread]: Partial parsing: updated file: pokemon://models/transform/fct_pokemon.sql
[0m09:10:59.741541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21952c9e-fe43-4e9a-a292-9f3f343a58b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03086cb990>]}
[0m09:10:59.756530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21952c9e-fe43-4e9a-a292-9f3f343a58b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03087d7f90>]}
[0m09:10:59.757185 [info ] [MainThread]: Found 3 models, 2 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m09:10:59.757697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21952c9e-fe43-4e9a-a292-9f3f343a58b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0308abc390>]}
[0m09:10:59.759373 [info ] [MainThread]: 
[0m09:10:59.760416 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:10:59.763077 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pokemon-403919'
[0m09:10:59.764158 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:11:00.423590 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pokemon-403919, now list_pokemon-403919_pokemon)
[0m09:11:00.425020 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:11:01.018935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21952c9e-fe43-4e9a-a292-9f3f343a58b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03088d4b50>]}
[0m09:11:01.020086 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:11:01.020661 [info ] [MainThread]: 
[0m09:11:01.028507 [debug] [Thread-1 (]: Began running node model.pokemon.dim_move
[0m09:11:01.029376 [info ] [Thread-1 (]: 1 of 3 START sql table model pokemon.dim_move .................................. [RUN]
[0m09:11:01.030819 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pokemon-403919_pokemon, now model.pokemon.dim_move)
[0m09:11:01.031734 [debug] [Thread-1 (]: Began compiling node model.pokemon.dim_move
[0m09:11:01.057113 [debug] [Thread-1 (]: Writing injected SQL for node "model.pokemon.dim_move"
[0m09:11:01.058133 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_move (compile): 09:11:01.032173 => 09:11:01.057820
[0m09:11:01.058730 [debug] [Thread-1 (]: Began executing node model.pokemon.dim_move
[0m09:11:01.076939 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:11:01.761702 [debug] [Thread-1 (]: Writing runtime sql for node "model.pokemon.dim_move"
[0m09:11:01.762731 [debug] [Thread-1 (]: On model.pokemon.dim_move: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "pokemon", "target_name": "dev", "node_id": "model.pokemon.dim_move"} */

  
    

    create or replace table `pokemon-403919`.`pokemon`.`dim_move`
      
    
    

    OPTIONS()
    as (
      WITH MovesData AS (
  SELECT
    id ,
    JSON_EXTRACT_ARRAY(moves, '$') AS moves_array
    FROM `pokemon-403919`.`pokemon`.`pokemon`
), 
move_cte AS(
    SELECT
    id AS pokemon_id,
    JSON_EXTRACT_SCALAR(move, '$.move') AS move,
    JSON_EXTRACT_SCALAR(move, '$.url') AS url,
    JSON_EXTRACT_SCALAR(move, '$.id') AS id
    FROM
    MovesData,
    UNNEST(moves_array) AS move
)
SELECT 
     to_hex(md5(cast(coalesce(cast(pokemon_id as string), '_dbt_utils_surrogate_key_null_') as string))) AS dim_move_key,
    pokemon_id,
    move,
    url,
    id
    FROM move_cte
    );
  
[0m09:11:02.123346 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pokemon-403919&j=bq:us-east1:640de32d-c99d-4232-87e4-ecfce415a8cf&page=queryresults
[0m09:11:04.467964 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_move (execute): 09:11:01.059216 => 09:11:04.464636
[0m09:11:04.470171 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21952c9e-fe43-4e9a-a292-9f3f343a58b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0308a78410>]}
[0m09:11:04.471520 [info ] [Thread-1 (]: 1 of 3 OK created sql table model pokemon.dim_move ............................. [[32mCREATE TABLE (81.4k rows, 6.3 MiB processed)[0m in 3.44s]
[0m09:11:04.473663 [debug] [Thread-1 (]: Finished running node model.pokemon.dim_move
[0m09:11:04.476818 [debug] [Thread-1 (]: Began running node model.pokemon.dim_type
[0m09:11:04.480134 [info ] [Thread-1 (]: 2 of 3 START sql table model pokemon.dim_type .................................. [RUN]
[0m09:11:04.490015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.pokemon.dim_move, now model.pokemon.dim_type)
[0m09:11:04.490811 [debug] [Thread-1 (]: Began compiling node model.pokemon.dim_type
[0m09:11:04.611794 [debug] [Thread-1 (]: Writing injected SQL for node "model.pokemon.dim_type"
[0m09:11:04.612877 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_type (compile): 09:11:04.491241 => 09:11:04.612546
[0m09:11:04.613445 [debug] [Thread-1 (]: Began executing node model.pokemon.dim_type
[0m09:11:04.617066 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:11:05.244395 [debug] [Thread-1 (]: Writing runtime sql for node "model.pokemon.dim_type"
[0m09:11:05.245335 [debug] [Thread-1 (]: On model.pokemon.dim_type: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "pokemon", "target_name": "dev", "node_id": "model.pokemon.dim_type"} */

  
    

    create or replace table `pokemon-403919`.`pokemon`.`dim_type`
      
    
    

    OPTIONS()
    as (
      WITH type_cte AS(
    SELECT DISTINCT
        to_hex(md5(cast(coalesce(cast(type1 as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(type2 as string), '_dbt_utils_surrogate_key_null_') as string))) AS dim_type_key,
        id AS pokemon_id,
        type1 AS primary_type,
        type2 AS secondary_type
    FROM `pokemon-403919`.`pokemon`.`pokemon`
)
SELECT *
FROM type_cte
    );
  
[0m09:11:05.589830 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pokemon-403919&j=bq:us-east1:01259521-f37c-491e-bbdc-44a011aa6063&page=queryresults
[0m09:11:07.301275 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_type (execute): 09:11:04.613788 => 09:11:07.300987
[0m09:11:07.302273 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21952c9e-fe43-4e9a-a292-9f3f343a58b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03089af190>]}
[0m09:11:07.303023 [info ] [Thread-1 (]: 2 of 3 OK created sql table model pokemon.dim_type ............................. [[32mCREATE TABLE (1.1k rows, 20.7 KiB processed)[0m in 2.81s]
[0m09:11:07.303923 [debug] [Thread-1 (]: Finished running node model.pokemon.dim_type
[0m09:11:07.305460 [debug] [Thread-1 (]: Began running node model.pokemon.fct_pokemon
[0m09:11:07.306367 [info ] [Thread-1 (]: 3 of 3 START sql table model pokemon.fct_pokemon ............................... [RUN]
[0m09:11:07.307673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.pokemon.dim_type, now model.pokemon.fct_pokemon)
[0m09:11:07.308220 [debug] [Thread-1 (]: Began compiling node model.pokemon.fct_pokemon
[0m09:11:07.312724 [debug] [Thread-1 (]: Writing injected SQL for node "model.pokemon.fct_pokemon"
[0m09:11:07.313593 [debug] [Thread-1 (]: Timing info for model.pokemon.fct_pokemon (compile): 09:11:07.308582 => 09:11:07.313300
[0m09:11:07.314096 [debug] [Thread-1 (]: Began executing node model.pokemon.fct_pokemon
[0m09:11:07.319577 [debug] [Thread-1 (]: Writing runtime sql for node "model.pokemon.fct_pokemon"
[0m09:11:07.320734 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:11:07.323064 [debug] [Thread-1 (]: On model.pokemon.fct_pokemon: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "pokemon", "target_name": "dev", "node_id": "model.pokemon.fct_pokemon"} */

  
    

    create or replace table `pokemon-403919`.`pokemon`.`fct_pokemon`
      
    
    

    OPTIONS()
    as (
      WITH fct_pokemon_cte AS (
    SELECT
        id,
        name,
        weight,
        height,
        type1,
        type2,
        hp + attack + defense + sp_atk + sp_def + speed AS total
    FROM `pokemon-403919`.`pokemon`.`pokemon`
)
SELECT
    pi.id,
    pi.name,
    pi.weight,
    pi.height,
    t.dim_type_key,
    m.dim_move_key,
FROM fct_pokemon_cte pi
INNER JOIN `pokemon-403919`.`pokemon`.`dim_type` t ON t.primary_type = pi.type1 AND (t.secondary_type = pi.type2 OR (t.secondary_type IS NULL AND pi.type2 IS NULL))
INNER JOIN `pokemon-403919`.`pokemon`.`dim_move` m on m.pokemon_id = pi.id
INNER JOIN `pokemon-403919`.`pokemon`.`pokemon` s ON pi.id = s.id
    );
  
[0m09:11:07.966906 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pokemon-403919&j=bq:us-east1:12dfbb2c-3470-46e6-8903-b65617cc4690&page=queryresults
[0m09:11:11.087786 [debug] [Thread-1 (]: Timing info for model.pokemon.fct_pokemon (execute): 09:11:07.314417 => 09:11:11.087505
[0m09:11:11.088750 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21952c9e-fe43-4e9a-a292-9f3f343a58b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0308ae8a10>]}
[0m09:11:11.089440 [info ] [Thread-1 (]: 3 of 3 OK created sql table model pokemon.fct_pokemon .......................... [[32mCREATE TABLE (1.9m rows, 3.4 MiB processed)[0m in 3.78s]
[0m09:11:11.090436 [debug] [Thread-1 (]: Finished running node model.pokemon.fct_pokemon
[0m09:11:11.092877 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:11:11.093332 [debug] [MainThread]: Connection 'model.pokemon.fct_pokemon' was properly closed.
[0m09:11:11.093773 [info ] [MainThread]: 
[0m09:11:11.094303 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 11.33 seconds (11.33s).
[0m09:11:11.095987 [debug] [MainThread]: Command end result
[0m09:11:11.108939 [info ] [MainThread]: 
[0m09:11:11.109552 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:11:11.109992 [info ] [MainThread]: 
[0m09:11:11.110507 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m09:11:11.111610 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.43934, "process_user_time": 3.97368, "process_kernel_time": 0.291001, "process_mem_max_rss": "159644", "process_out_blocks": "3504", "process_in_blocks": "0"}
[0m09:11:11.112318 [debug] [MainThread]: Command `dbt run` succeeded at 09:11:11.112144 after 12.44 seconds
[0m09:11:11.112830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f030aea2dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f030a8fb5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f030fa0f790>]}
[0m09:11:11.113328 [debug] [MainThread]: Flushing usage events
[0m09:12:02.555726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69a56608d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69a5651c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69a5652ad0>]}


============================== 09:12:02.560396 | 17aa859e-988f-40bf-a9c3-2127d162ac26 ==============================
[0m09:12:02.560396 [info ] [MainThread]: Running with dbt=1.7.1
[0m09:12:02.561133 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'warn_error': 'None', 'partial_parse': 'True', 'static_parser': 'True', 'debug': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt', 'profiles_dir': '/usr/local/airflow/include/dbt', 'cache_selected_only': 'False', 'write_json': 'True', 'quiet': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'indirect_selection': 'eager', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'use_colors': 'True', 'fail_fast': 'False', 'target_path': 'None', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'introspect': 'True'}
[0m09:12:03.155455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17aa859e-988f-40bf-a9c3-2127d162ac26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69a38eee10>]}
[0m09:12:03.278172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17aa859e-988f-40bf-a9c3-2127d162ac26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69a567c610>]}
[0m09:12:03.279425 [info ] [MainThread]: Registered adapter: bigquery=1.7.1
[0m09:12:03.312224 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m09:12:03.357601 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:12:03.358513 [debug] [MainThread]: Partial parsing: updated file: pokemon://models/transform/fct_pokemon.sql
[0m09:12:03.531524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17aa859e-988f-40bf-a9c3-2127d162ac26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69a3484cd0>]}
[0m09:12:03.548935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17aa859e-988f-40bf-a9c3-2127d162ac26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69a36d15d0>]}
[0m09:12:03.550264 [info ] [MainThread]: Found 3 models, 2 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m09:12:03.552473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17aa859e-988f-40bf-a9c3-2127d162ac26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69a376b810>]}
[0m09:12:03.554591 [info ] [MainThread]: 
[0m09:12:03.555771 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:12:03.557485 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pokemon-403919'
[0m09:12:03.558150 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:12:04.176286 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pokemon-403919, now list_pokemon-403919_pokemon)
[0m09:12:04.177245 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:12:04.747133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17aa859e-988f-40bf-a9c3-2127d162ac26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69a3730a90>]}
[0m09:12:04.748259 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:12:04.748827 [info ] [MainThread]: 
[0m09:12:04.757017 [debug] [Thread-1 (]: Began running node model.pokemon.dim_move
[0m09:12:04.757816 [info ] [Thread-1 (]: 1 of 3 START sql table model pokemon.dim_move .................................. [RUN]
[0m09:12:04.758888 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pokemon-403919_pokemon, now model.pokemon.dim_move)
[0m09:12:04.759442 [debug] [Thread-1 (]: Began compiling node model.pokemon.dim_move
[0m09:12:04.783005 [debug] [Thread-1 (]: Writing injected SQL for node "model.pokemon.dim_move"
[0m09:12:04.784318 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_move (compile): 09:12:04.759769 => 09:12:04.783896
[0m09:12:04.785182 [debug] [Thread-1 (]: Began executing node model.pokemon.dim_move
[0m09:12:04.802402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:12:05.442236 [debug] [Thread-1 (]: Writing runtime sql for node "model.pokemon.dim_move"
[0m09:12:05.443271 [debug] [Thread-1 (]: On model.pokemon.dim_move: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "pokemon", "target_name": "dev", "node_id": "model.pokemon.dim_move"} */

  
    

    create or replace table `pokemon-403919`.`pokemon`.`dim_move`
      
    
    

    OPTIONS()
    as (
      WITH MovesData AS (
  SELECT
    id ,
    JSON_EXTRACT_ARRAY(moves, '$') AS moves_array
    FROM `pokemon-403919`.`pokemon`.`pokemon`
), 
move_cte AS(
    SELECT
    id AS pokemon_id,
    JSON_EXTRACT_SCALAR(move, '$.move') AS move,
    JSON_EXTRACT_SCALAR(move, '$.url') AS url,
    JSON_EXTRACT_SCALAR(move, '$.id') AS id
    FROM
    MovesData,
    UNNEST(moves_array) AS move
)
SELECT 
     to_hex(md5(cast(coalesce(cast(pokemon_id as string), '_dbt_utils_surrogate_key_null_') as string))) AS dim_move_key,
    pokemon_id,
    move,
    url,
    id
    FROM move_cte
    );
  
[0m09:12:05.800799 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pokemon-403919&j=bq:us-east1:ff445189-5b29-4795-86e2-bad3dcd08e61&page=queryresults
[0m09:12:08.065764 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_move (execute): 09:12:04.785750 => 09:12:08.065465
[0m09:12:08.066926 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17aa859e-988f-40bf-a9c3-2127d162ac26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69a379d190>]}
[0m09:12:08.067801 [info ] [Thread-1 (]: 1 of 3 OK created sql table model pokemon.dim_move ............................. [[32mCREATE TABLE (81.4k rows, 6.3 MiB processed)[0m in 3.31s]
[0m09:12:08.068728 [debug] [Thread-1 (]: Finished running node model.pokemon.dim_move
[0m09:12:08.069448 [debug] [Thread-1 (]: Began running node model.pokemon.dim_type
[0m09:12:08.070200 [info ] [Thread-1 (]: 2 of 3 START sql table model pokemon.dim_type .................................. [RUN]
[0m09:12:08.071147 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.pokemon.dim_move, now model.pokemon.dim_type)
[0m09:12:08.071650 [debug] [Thread-1 (]: Began compiling node model.pokemon.dim_type
[0m09:12:08.178831 [debug] [Thread-1 (]: Writing injected SQL for node "model.pokemon.dim_type"
[0m09:12:08.179882 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_type (compile): 09:12:08.071978 => 09:12:08.179548
[0m09:12:08.180511 [debug] [Thread-1 (]: Began executing node model.pokemon.dim_type
[0m09:12:08.184099 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:12:08.791020 [debug] [Thread-1 (]: Writing runtime sql for node "model.pokemon.dim_type"
[0m09:12:08.793553 [debug] [Thread-1 (]: On model.pokemon.dim_type: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "pokemon", "target_name": "dev", "node_id": "model.pokemon.dim_type"} */

  
    

    create or replace table `pokemon-403919`.`pokemon`.`dim_type`
      
    
    

    OPTIONS()
    as (
      WITH type_cte AS(
    SELECT DISTINCT
        to_hex(md5(cast(coalesce(cast(type1 as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(type2 as string), '_dbt_utils_surrogate_key_null_') as string))) AS dim_type_key,
        id AS pokemon_id,
        type1 AS primary_type,
        type2 AS secondary_type
    FROM `pokemon-403919`.`pokemon`.`pokemon`
)
SELECT *
FROM type_cte
    );
  
[0m09:12:09.145726 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pokemon-403919&j=bq:us-east1:522099bc-ecac-46db-84db-d7e836c49649&page=queryresults
[0m09:12:11.145967 [debug] [Thread-1 (]: Timing info for model.pokemon.dim_type (execute): 09:12:08.180870 => 09:12:11.145665
[0m09:12:11.147230 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17aa859e-988f-40bf-a9c3-2127d162ac26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69a345bd50>]}
[0m09:12:11.148254 [info ] [Thread-1 (]: 2 of 3 OK created sql table model pokemon.dim_type ............................. [[32mCREATE TABLE (1.1k rows, 20.7 KiB processed)[0m in 3.08s]
[0m09:12:11.149508 [debug] [Thread-1 (]: Finished running node model.pokemon.dim_type
[0m09:12:11.152344 [debug] [Thread-1 (]: Began running node model.pokemon.fct_pokemon
[0m09:12:11.153729 [info ] [Thread-1 (]: 3 of 3 START sql table model pokemon.fct_pokemon ............................... [RUN]
[0m09:12:11.155396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.pokemon.dim_type, now model.pokemon.fct_pokemon)
[0m09:12:11.156234 [debug] [Thread-1 (]: Began compiling node model.pokemon.fct_pokemon
[0m09:12:11.161157 [debug] [Thread-1 (]: Writing injected SQL for node "model.pokemon.fct_pokemon"
[0m09:12:11.162335 [debug] [Thread-1 (]: Timing info for model.pokemon.fct_pokemon (compile): 09:12:11.156625 => 09:12:11.161940
[0m09:12:11.163119 [debug] [Thread-1 (]: Began executing node model.pokemon.fct_pokemon
[0m09:12:11.166689 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:12:11.769930 [debug] [Thread-1 (]: Writing runtime sql for node "model.pokemon.fct_pokemon"
[0m09:12:11.773484 [debug] [Thread-1 (]: On model.pokemon.fct_pokemon: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "pokemon", "target_name": "dev", "node_id": "model.pokemon.fct_pokemon"} */

  
    

    create or replace table `pokemon-403919`.`pokemon`.`fct_pokemon`
      
    
    

    OPTIONS()
    as (
      WITH fct_pokemon_cte AS (
    SELECT
        id,
        name,
        weight,
        height,
        type1,
        type2,
        hp + attack + defense + sp_atk + sp_def + speed AS total
    FROM `pokemon-403919`.`pokemon`.`pokemon`
)
SELECT DISTINCT
    pi.id,
    pi.name,
    pi.weight,
    pi.height,
    t.dim_type_key,
    m.dim_move_key,
FROM fct_pokemon_cte pi
INNER JOIN `pokemon-403919`.`pokemon`.`dim_type` t ON t.primary_type = pi.type1 AND (t.secondary_type = pi.type2 OR (t.secondary_type IS NULL AND pi.type2 IS NULL))
INNER JOIN `pokemon-403919`.`pokemon`.`dim_move` m on m.pokemon_id = pi.id
INNER JOIN `pokemon-403919`.`pokemon`.`pokemon` s ON pi.id = s.id
    );
  
[0m09:12:12.112401 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pokemon-403919&j=bq:us-east1:fed62d5d-acf8-480b-a134-8b2ad41e50c4&page=queryresults
[0m09:12:14.669356 [debug] [Thread-1 (]: Timing info for model.pokemon.fct_pokemon (execute): 09:12:11.163593 => 09:12:14.668649
[0m09:12:14.671223 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17aa859e-988f-40bf-a9c3-2127d162ac26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69a3a30a90>]}
[0m09:12:14.672476 [info ] [Thread-1 (]: 3 of 3 OK created sql table model pokemon.fct_pokemon .......................... [[32mCREATE TABLE (1.1k rows, 3.4 MiB processed)[0m in 3.52s]
[0m09:12:14.673749 [debug] [Thread-1 (]: Finished running node model.pokemon.fct_pokemon
[0m09:12:14.677331 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:12:14.677960 [debug] [MainThread]: Connection 'model.pokemon.fct_pokemon' was properly closed.
[0m09:12:14.679138 [info ] [MainThread]: 
[0m09:12:14.679890 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 11.12 seconds (11.12s).
[0m09:12:14.682080 [debug] [MainThread]: Command end result
[0m09:12:14.701133 [info ] [MainThread]: 
[0m09:12:14.702394 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:12:14.703202 [info ] [MainThread]: 
[0m09:12:14.704350 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m09:12:14.706511 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.196367, "process_user_time": 3.890821, "process_kernel_time": 0.287841, "process_mem_max_rss": "160284", "process_out_blocks": "3496", "process_in_blocks": "0"}
[0m09:12:14.707453 [debug] [MainThread]: Command `dbt run` succeeded at 09:12:14.707167 after 12.20 seconds
[0m09:12:14.708139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69a58eae90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69aa702b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69a5c144d0>]}
[0m09:12:14.708688 [debug] [MainThread]: Flushing usage events
[0m13:13:21.587545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e48668310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e48886010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e48687ed0>]}


============================== 13:13:21.594120 | 2ad33381-e0f2-4e76-a2b1-584bbc2f1241 ==============================
[0m13:13:21.594120 [info ] [MainThread]: Running with dbt=1.7.1
[0m13:13:21.594963 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'no_print': 'None', 'log_format': 'default', 'use_experimental_parser': 'False', 'invocation_command': 'dbt deps', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'introspect': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'partial_parse': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'write_json': 'True', 'quiet': 'False', 'static_parser': 'True', 'printer_width': '80'}
[0m13:13:21.696436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ad33381-e0f2-4e76-a2b1-584bbc2f1241', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e486a1710>]}
[0m13:13:21.727031 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-j0mj2z6k'
[0m13:13:21.727659 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:13:21.829449 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:13:21.832181 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:13:21.917681 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:13:21.924448 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:13:22.381689 [info ] [MainThread]: Installed from version 1.1.1
[0m13:13:22.382268 [info ] [MainThread]: Up to date!
[0m13:13:22.382820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2ad33381-e0f2-4e76-a2b1-584bbc2f1241', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e48caeb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e48c122d0>]}
[0m13:13:22.384075 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.84154516, "process_user_time": 2.239528, "process_kernel_time": 0.413606, "process_mem_max_rss": "114524", "process_in_blocks": "66792", "process_out_blocks": "2224"}
[0m13:13:22.384783 [debug] [MainThread]: Command `dbt deps` succeeded at 13:13:22.384534 after 0.84 seconds
[0m13:13:22.385270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e48a12bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e4d7cf8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e48957cd0>]}
[0m13:13:22.385768 [debug] [MainThread]: Flushing usage events
[0m13:14:17.542667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f441e8a9e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f441eab9510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f441ebd7e10>]}


============================== 13:14:17.547652 | f7e68531-0c55-468f-a6d1-067f1fd2c54a ==============================
[0m13:14:17.547652 [info ] [MainThread]: Running with dbt=1.7.1
[0m13:14:17.548393 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'printer_width': '80', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'warn_error': 'None', 'fail_fast': 'False', 'write_json': 'True', 'use_colors': 'True', 'invocation_command': 'dbt run --select path:models/report --profiles-dir /usr/local/airflow/include/dbt/', 'log_format': 'default', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'quiet': 'False', 'target_path': 'None', 'use_experimental_parser': 'False'}
[0m13:14:18.355231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f7e68531-0c55-468f-a6d1-067f1fd2c54a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f441c8b76d0>]}
[0m13:14:18.447810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f7e68531-0c55-468f-a6d1-067f1fd2c54a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f441e69ca90>]}
[0m13:14:18.450563 [info ] [MainThread]: Registered adapter: bigquery=1.7.1
[0m13:14:18.467774 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m13:14:18.552605 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m13:14:18.553340 [debug] [MainThread]: Partial parsing: added file: pokemon://models/report/report_type_invoices.sql
[0m13:14:18.553860 [debug] [MainThread]: Partial parsing: updated file: pokemon://models/transform/fct_pokemon.sql
[0m13:14:18.753153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f7e68531-0c55-468f-a6d1-067f1fd2c54a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f441c7f7a90>]}
[0m13:14:18.768413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f7e68531-0c55-468f-a6d1-067f1fd2c54a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f441c720d90>]}
[0m13:14:18.769068 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m13:14:18.769545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7e68531-0c55-468f-a6d1-067f1fd2c54a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f441c7ae110>]}
[0m13:14:18.771182 [info ] [MainThread]: 
[0m13:14:18.772204 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:14:18.773728 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pokemon-403919'
[0m13:14:18.774404 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:14:19.563257 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pokemon-403919, now list_pokemon-403919_pokemon)
[0m13:14:19.563997 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:14:20.137332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7e68531-0c55-468f-a6d1-067f1fd2c54a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f441c4f51d0>]}
[0m13:14:20.138341 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:14:20.138861 [info ] [MainThread]: 
[0m13:14:20.146554 [debug] [Thread-1 (]: Began running node model.pokemon.report_type_invoices
[0m13:14:20.147391 [info ] [Thread-1 (]: 1 of 1 START sql table model pokemon.report_type_invoices ...................... [RUN]
[0m13:14:20.148514 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pokemon-403919_pokemon, now model.pokemon.report_type_invoices)
[0m13:14:20.149184 [debug] [Thread-1 (]: Began compiling node model.pokemon.report_type_invoices
[0m13:14:20.158686 [debug] [Thread-1 (]: Writing injected SQL for node "model.pokemon.report_type_invoices"
[0m13:14:20.160293 [debug] [Thread-1 (]: Timing info for model.pokemon.report_type_invoices (compile): 13:14:20.149578 => 13:14:20.159830
[0m13:14:20.161188 [debug] [Thread-1 (]: Began executing node model.pokemon.report_type_invoices
[0m13:14:20.204449 [debug] [Thread-1 (]: Writing runtime sql for node "model.pokemon.report_type_invoices"
[0m13:14:20.205552 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:14:20.207335 [debug] [Thread-1 (]: On model.pokemon.report_type_invoices: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "pokemon", "target_name": "dev", "node_id": "model.pokemon.report_type_invoices"} */

  
    

    create or replace table `pokemon-403919`.`pokemon`.`report_type_invoices`
      
    
    

    OPTIONS()
    as (
      SELECT
    t.type1,
    t.type2
    COUNT(pi.dim_type_key) AS full_type
FROM `pokemon-403919`.`pokemon`.`fct_pokemon` pi
JOIN `pokemon-403919`.`pokemon`.`dim_type` t on pi.dim_type_key = t.dim_type_key
GROUP BY t.type1, t.type2
ORDER BY full_type DESC
LIMIT 10
    );
  
[0m13:14:20.820257 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pokemon-403919&j=bq:us-east1:ced0dde6-0ec5-4bde-ac28-da32e34fd95f&page=queryresults
[0m13:14:20.823724 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got "(" at [16:10]')
[0m13:14:21.520925 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pokemon-403919&j=bq:us-east1:476ec724-43a6-4fd7-9317-5dbcc614643f&page=queryresults
[0m13:14:21.523110 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pokemon-403919&j=bq:us-east1:476ec724-43a6-4fd7-9317-5dbcc614643f&page=queryresults
[0m13:14:21.524917 [debug] [Thread-1 (]: Timing info for model.pokemon.report_type_invoices (execute): 13:14:20.161697 => 13:14:21.524348
[0m13:14:21.543174 [debug] [Thread-1 (]: Database Error in model report_type_invoices (models/report/report_type_invoices.sql)
  Syntax error: Expected ")" but got "(" at [16:10]
  compiled Code at target/run/pokemon/models/report/report_type_invoices.sql
[0m13:14:21.544038 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7e68531-0c55-468f-a6d1-067f1fd2c54a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f441c5802d0>]}
[0m13:14:21.545058 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model pokemon.report_type_invoices ............. [[31mERROR[0m in 1.40s]
[0m13:14:21.546152 [debug] [Thread-1 (]: Finished running node model.pokemon.report_type_invoices
[0m13:14:21.548766 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:14:21.549202 [debug] [MainThread]: Connection 'model.pokemon.report_type_invoices' was properly closed.
[0m13:14:21.549636 [info ] [MainThread]: 
[0m13:14:21.550294 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.78 seconds (2.78s).
[0m13:14:21.551269 [debug] [MainThread]: Command end result
[0m13:14:21.678561 [info ] [MainThread]: 
[0m13:14:21.679494 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:14:21.680365 [info ] [MainThread]: 
[0m13:14:21.681130 [error] [MainThread]:   Database Error in model report_type_invoices (models/report/report_type_invoices.sql)
  Syntax error: Expected ")" but got "(" at [16:10]
  compiled Code at target/run/pokemon/models/report/report_type_invoices.sql
[0m13:14:21.681709 [info ] [MainThread]: 
[0m13:14:21.682349 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:14:21.683434 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.185351, "process_user_time": 3.570669, "process_kernel_time": 0.230043, "process_mem_max_rss": "159740", "process_in_blocks": "26200", "process_out_blocks": "3472", "command_success": false}
[0m13:14:21.684183 [debug] [MainThread]: Command `dbt run` failed at 13:14:21.683992 after 4.19 seconds
[0m13:14:21.684787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f441e8cb010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f441e8cb4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f441e8caa50>]}
[0m13:14:21.685284 [debug] [MainThread]: Flushing usage events
[0m13:15:47.024805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac18af4f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac190c4a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac19161a50>]}


============================== 13:15:47.030314 | 8bf49d4b-ba18-4af6-9d15-3b6c453b5a56 ==============================
[0m13:15:47.030314 [info ] [MainThread]: Running with dbt=1.7.1
[0m13:15:47.031088 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'log_cache_events': 'False', 'version_check': 'True', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'debug': 'False', 'quiet': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select path:models/report --profiles-dir /usr/local/airflow/include/dbt/', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/usr/local/airflow/include/dbt/logs', 'static_parser': 'True', 'fail_fast': 'False', 'write_json': 'True', 'printer_width': '80', 'target_path': 'None', 'warn_error': 'None', 'no_print': 'None', 'use_experimental_parser': 'False'}
[0m13:15:47.605310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8bf49d4b-ba18-4af6-9d15-3b6c453b5a56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac16eef650>]}
[0m13:15:47.712846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8bf49d4b-ba18-4af6-9d15-3b6c453b5a56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac16c7ae90>]}
[0m13:15:47.713988 [info ] [MainThread]: Registered adapter: bigquery=1.7.1
[0m13:15:47.732096 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m13:15:47.767445 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:15:47.768253 [debug] [MainThread]: Partial parsing: updated file: pokemon://models/report/report_type_invoices.sql
[0m13:15:47.916835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8bf49d4b-ba18-4af6-9d15-3b6c453b5a56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac16afb310>]}
[0m13:15:47.931318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8bf49d4b-ba18-4af6-9d15-3b6c453b5a56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac16bdf910>]}
[0m13:15:47.931943 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m13:15:47.932439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8bf49d4b-ba18-4af6-9d15-3b6c453b5a56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac16dda150>]}
[0m13:15:47.934063 [info ] [MainThread]: 
[0m13:15:47.935079 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:15:47.936431 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pokemon-403919'
[0m13:15:47.937016 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:15:48.666964 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pokemon-403919, now list_pokemon-403919_pokemon)
[0m13:15:48.669730 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:15:49.302396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8bf49d4b-ba18-4af6-9d15-3b6c453b5a56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac16ac6c10>]}
[0m13:15:49.305135 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:15:49.306607 [info ] [MainThread]: 
[0m13:15:49.323897 [debug] [Thread-1 (]: Began running node model.pokemon.report_type_invoices
[0m13:15:49.325307 [info ] [Thread-1 (]: 1 of 1 START sql table model pokemon.report_type_invoices ...................... [RUN]
[0m13:15:49.327312 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pokemon-403919_pokemon, now model.pokemon.report_type_invoices)
[0m13:15:49.328325 [debug] [Thread-1 (]: Began compiling node model.pokemon.report_type_invoices
[0m13:15:49.340579 [debug] [Thread-1 (]: Writing injected SQL for node "model.pokemon.report_type_invoices"
[0m13:15:49.341826 [debug] [Thread-1 (]: Timing info for model.pokemon.report_type_invoices (compile): 13:15:49.329020 => 13:15:49.341337
[0m13:15:49.342584 [debug] [Thread-1 (]: Began executing node model.pokemon.report_type_invoices
[0m13:15:49.389238 [debug] [Thread-1 (]: Writing runtime sql for node "model.pokemon.report_type_invoices"
[0m13:15:49.390125 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:15:49.391886 [debug] [Thread-1 (]: On model.pokemon.report_type_invoices: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "pokemon", "target_name": "dev", "node_id": "model.pokemon.report_type_invoices"} */

  
    

    create or replace table `pokemon-403919`.`pokemon`.`report_type_invoices`
      
    
    

    OPTIONS()
    as (
      SELECT
    t.primary_type,
    t.secondary_type,
    COUNT(pi.dim_type_key) AS full_type
FROM `pokemon-403919`.`pokemon`.`dim_type` pi 
JOIN `pokemon-403919`.`pokemon`.`fct_pokemon` t on pi.dim_type_key = t.dim_type_key
GROUP BY t.primary_type, t.secondary_type
ORDER BY full_type DESC
LIMIT 10
    );
  
[0m13:15:50.230145 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pokemon-403919&j=bq:us-east1:5b19e485-0956-4f78-91b8-2913049a7330&page=queryresults
[0m13:15:50.690629 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name primary_type not found inside t at [14:7]')
[0m13:15:52.068674 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pokemon-403919&j=bq:us-east1:6b982494-3214-4891-91c8-ede4c283518e&page=queryresults
[0m13:15:52.494186 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pokemon-403919&j=bq:us-east1:6b982494-3214-4891-91c8-ede4c283518e&page=queryresults
[0m13:15:52.495588 [debug] [Thread-1 (]: Timing info for model.pokemon.report_type_invoices (execute): 13:15:49.344702 => 13:15:52.495166
[0m13:15:52.501036 [debug] [Thread-1 (]: Database Error in model report_type_invoices (models/report/report_type_invoices.sql)
  Name primary_type not found inside t at [14:7]
  compiled Code at target/run/pokemon/models/report/report_type_invoices.sql
[0m13:15:52.501766 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bf49d4b-ba18-4af6-9d15-3b6c453b5a56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac169dd710>]}
[0m13:15:52.502641 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model pokemon.report_type_invoices ............. [[31mERROR[0m in 3.18s]
[0m13:15:52.503629 [debug] [Thread-1 (]: Finished running node model.pokemon.report_type_invoices
[0m13:15:52.506593 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:15:52.507060 [debug] [MainThread]: Connection 'model.pokemon.report_type_invoices' was properly closed.
[0m13:15:52.507488 [info ] [MainThread]: 
[0m13:15:52.508018 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.57 seconds (4.57s).
[0m13:15:52.508946 [debug] [MainThread]: Command end result
[0m13:15:52.634735 [info ] [MainThread]: 
[0m13:15:52.635390 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:15:52.635880 [info ] [MainThread]: 
[0m13:15:52.636365 [error] [MainThread]:   Database Error in model report_type_invoices (models/report/report_type_invoices.sql)
  Name primary_type not found inside t at [14:7]
  compiled Code at target/run/pokemon/models/report/report_type_invoices.sql
[0m13:15:52.636835 [info ] [MainThread]: 
[0m13:15:52.637401 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:15:52.640122 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.6582055, "process_user_time": 3.403957, "process_kernel_time": 0.220256, "process_mem_max_rss": "157972", "process_out_blocks": "3464", "command_success": false, "process_in_blocks": "0"}
[0m13:15:52.641181 [debug] [MainThread]: Command `dbt run` failed at 13:15:52.640965 after 5.66 seconds
[0m13:15:52.642120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac1a3a2510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac18deab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac1dc83990>]}
[0m13:15:52.643876 [debug] [MainThread]: Flushing usage events
[0m13:16:15.720804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8c961a1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8c69d7250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8c6616290>]}


============================== 13:16:15.725700 | 633439d5-7c3c-43dd-acae-3708ea907f40 ==============================
[0m13:16:15.725700 [info ] [MainThread]: Running with dbt=1.7.1
[0m13:16:15.726562 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/usr/local/airflow/include/dbt/', 'printer_width': '80', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'invocation_command': 'dbt run --select path:models/report --profiles-dir /usr/local/airflow/include/dbt/', 'partial_parse': 'True', 'quiet': 'False', 'fail_fast': 'False', 'target_path': 'None', 'no_print': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'debug': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'version_check': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m13:16:16.328039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '633439d5-7c3c-43dd-acae-3708ea907f40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8c6254d10>]}
[0m13:16:16.431835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '633439d5-7c3c-43dd-acae-3708ea907f40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8c6284050>]}
[0m13:16:16.432748 [info ] [MainThread]: Registered adapter: bigquery=1.7.1
[0m13:16:16.448958 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m13:16:16.486106 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:16:16.486868 [debug] [MainThread]: Partial parsing: updated file: pokemon://models/report/report_type_invoices.sql
[0m13:16:16.641315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '633439d5-7c3c-43dd-acae-3708ea907f40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8c440ddd0>]}
[0m13:16:16.656166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '633439d5-7c3c-43dd-acae-3708ea907f40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8c432c210>]}
[0m13:16:16.656822 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m13:16:16.657325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '633439d5-7c3c-43dd-acae-3708ea907f40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8c4219610>]}
[0m13:16:16.658854 [info ] [MainThread]: 
[0m13:16:16.659939 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:16:16.661619 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pokemon-403919'
[0m13:16:16.662315 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:16:17.353489 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pokemon-403919, now list_pokemon-403919_pokemon)
[0m13:16:17.354141 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:16:17.930039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '633439d5-7c3c-43dd-acae-3708ea907f40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8c42734d0>]}
[0m13:16:17.931046 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:16:17.931545 [info ] [MainThread]: 
[0m13:16:17.938721 [debug] [Thread-1 (]: Began running node model.pokemon.report_type_invoices
[0m13:16:17.939466 [info ] [Thread-1 (]: 1 of 1 START sql table model pokemon.report_type_invoices ...................... [RUN]
[0m13:16:17.940910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pokemon-403919_pokemon, now model.pokemon.report_type_invoices)
[0m13:16:17.941586 [debug] [Thread-1 (]: Began compiling node model.pokemon.report_type_invoices
[0m13:16:17.951537 [debug] [Thread-1 (]: Writing injected SQL for node "model.pokemon.report_type_invoices"
[0m13:16:17.952483 [debug] [Thread-1 (]: Timing info for model.pokemon.report_type_invoices (compile): 13:16:17.942022 => 13:16:17.952187
[0m13:16:17.953021 [debug] [Thread-1 (]: Began executing node model.pokemon.report_type_invoices
[0m13:16:17.998927 [debug] [Thread-1 (]: Writing runtime sql for node "model.pokemon.report_type_invoices"
[0m13:16:17.999807 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:16:18.001618 [debug] [Thread-1 (]: On model.pokemon.report_type_invoices: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "pokemon", "target_name": "dev", "node_id": "model.pokemon.report_type_invoices"} */

  
    

    create or replace table `pokemon-403919`.`pokemon`.`report_type_invoices`
      
    
    

    OPTIONS()
    as (
      SELECT
    t.primary_type,
    t.secondary_type,
    COUNT(pi.dim_type_key) AS full_type
FROM `pokemon-403919`.`pokemon`.`dim_type` t 
JOIN `pokemon-403919`.`pokemon`.`fct_pokemon` pi on pi.dim_type_key = t.dim_type_key
GROUP BY t.primary_type, t.secondary_type
ORDER BY full_type DESC
LIMIT 10
    );
  
[0m13:16:18.717563 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pokemon-403919&j=bq:us-east1:6fd4acf6-9001-43f5-a859-a418591bb722&page=queryresults
[0m13:16:20.874681 [debug] [Thread-1 (]: Timing info for model.pokemon.report_type_invoices (execute): 13:16:17.953350 => 13:16:20.874348
[0m13:16:20.875770 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '633439d5-7c3c-43dd-acae-3708ea907f40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8c4273690>]}
[0m13:16:20.876674 [info ] [Thread-1 (]: 1 of 1 OK created sql table model pokemon.report_type_invoices ................. [[32mCREATE TABLE (10.0 rows, 85.2 KiB processed)[0m in 2.94s]
[0m13:16:20.877646 [debug] [Thread-1 (]: Finished running node model.pokemon.report_type_invoices
[0m13:16:20.880142 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:16:20.880604 [debug] [MainThread]: Connection 'model.pokemon.report_type_invoices' was properly closed.
[0m13:16:20.881044 [info ] [MainThread]: 
[0m13:16:20.881577 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.22 seconds (4.22s).
[0m13:16:20.882475 [debug] [MainThread]: Command end result
[0m13:16:21.006352 [info ] [MainThread]: 
[0m13:16:21.007098 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:16:21.007620 [info ] [MainThread]: 
[0m13:16:21.008441 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:16:21.009972 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.335901, "process_user_time": 3.480305, "process_kernel_time": 0.130386, "process_mem_max_rss": "157576", "process_out_blocks": "3464", "process_in_blocks": "0"}
[0m13:16:21.010792 [debug] [MainThread]: Command `dbt run` succeeded at 13:16:21.010597 after 5.34 seconds
[0m13:16:21.011403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8c66befd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8c68e9f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8cb3cf990>]}
[0m13:16:21.011974 [debug] [MainThread]: Flushing usage events
[0m13:21:35.004759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cc0ef2390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cc0ef08d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cc0b90110>]}


============================== 13:21:35.009402 | d264f793-2627-41ff-b01f-d6ba5365173f ==============================
[0m13:21:35.009402 [info ] [MainThread]: Running with dbt=1.7.1
[0m13:21:35.010293 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/usr/local/airflow/include/dbt/', 'log_format': 'default', 'fail_fast': 'False', 'static_parser': 'True', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select path:models/report --profiles-dir /usr/local/airflow/include/dbt/', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'quiet': 'False', 'introspect': 'True'}
[0m13:21:35.648261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd264f793-2627-41ff-b01f-d6ba5365173f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cbeaeb6d0>]}
[0m13:21:35.749892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd264f793-2627-41ff-b01f-d6ba5365173f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cc08c05d0>]}
[0m13:21:35.751282 [info ] [MainThread]: Registered adapter: bigquery=1.7.1
[0m13:21:35.776354 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m13:21:35.820337 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:21:35.821312 [debug] [MainThread]: Partial parsing: updated file: pokemon://models/report/report_type_invoices.sql
[0m13:21:35.985097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd264f793-2627-41ff-b01f-d6ba5365173f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cbea01e10>]}
[0m13:21:35.999005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd264f793-2627-41ff-b01f-d6ba5365173f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cbeae4d90>]}
[0m13:21:35.999615 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m13:21:36.000101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd264f793-2627-41ff-b01f-d6ba5365173f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cbe702110>]}
[0m13:21:36.001886 [info ] [MainThread]: 
[0m13:21:36.002984 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:21:36.004376 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pokemon-403919'
[0m13:21:36.005056 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:36.769127 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pokemon-403919, now list_pokemon-403919_pokemon)
[0m13:21:36.769901 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:21:37.346575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd264f793-2627-41ff-b01f-d6ba5365173f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cbe7926d0>]}
[0m13:21:37.347605 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:21:37.348117 [info ] [MainThread]: 
[0m13:21:37.355755 [debug] [Thread-1 (]: Began running node model.pokemon.report_type_invoices
[0m13:21:37.356670 [info ] [Thread-1 (]: 1 of 1 START sql table model pokemon.report_type_invoices ...................... [RUN]
[0m13:21:37.357882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pokemon-403919_pokemon, now model.pokemon.report_type_invoices)
[0m13:21:37.358654 [debug] [Thread-1 (]: Began compiling node model.pokemon.report_type_invoices
[0m13:21:37.368631 [debug] [Thread-1 (]: Writing injected SQL for node "model.pokemon.report_type_invoices"
[0m13:21:37.369562 [debug] [Thread-1 (]: Timing info for model.pokemon.report_type_invoices (compile): 13:21:37.359182 => 13:21:37.369264
[0m13:21:37.370090 [debug] [Thread-1 (]: Began executing node model.pokemon.report_type_invoices
[0m13:21:37.386040 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:38.046130 [debug] [Thread-1 (]: Writing runtime sql for node "model.pokemon.report_type_invoices"
[0m13:21:38.047035 [debug] [Thread-1 (]: On model.pokemon.report_type_invoices: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "pokemon", "target_name": "dev", "node_id": "model.pokemon.report_type_invoices"} */

  
    

    create or replace table `pokemon-403919`.`pokemon`.`report_type_invoices`
      
    
    

    OPTIONS()
    as (
      SELECT
    t.primary_type,
    t.secondary_type,
    COUNT(pi.dim_type_key) AS full_type
FROM `pokemon-403919`.`pokemon`.`dim_type` t 
INNER JOIN `pokemon-403919`.`pokemon`.`fct_pokemon` pi on pi.dim_type_key = t.dim_type_key
GROUP BY t.primary_type, t.secondary_type
ORDER BY full_type DESC
LIMIT 10
    );
  
[0m13:21:38.478698 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pokemon-403919&j=bq:us-east1:be9e5056-99c6-4a66-b3c0-00d752b15131&page=queryresults
[0m13:21:40.519680 [debug] [Thread-1 (]: Timing info for model.pokemon.report_type_invoices (execute): 13:21:37.370427 => 13:21:40.519332
[0m13:21:40.520909 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd264f793-2627-41ff-b01f-d6ba5365173f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cbe923710>]}
[0m13:21:40.521851 [info ] [Thread-1 (]: 1 of 1 OK created sql table model pokemon.report_type_invoices ................. [[32mCREATE TABLE (10.0 rows, 85.2 KiB processed)[0m in 3.16s]
[0m13:21:40.522943 [debug] [Thread-1 (]: Finished running node model.pokemon.report_type_invoices
[0m13:21:40.525915 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:21:40.526502 [debug] [MainThread]: Connection 'model.pokemon.report_type_invoices' was properly closed.
[0m13:21:40.527098 [info ] [MainThread]: 
[0m13:21:40.527703 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.52 seconds (4.52s).
[0m13:21:40.529133 [debug] [MainThread]: Command end result
[0m13:21:40.686798 [info ] [MainThread]: 
[0m13:21:40.687533 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:21:40.688042 [info ] [MainThread]: 
[0m13:21:40.688590 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:21:40.689856 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.730536, "process_user_time": 3.471809, "process_kernel_time": 0.282589, "process_mem_max_rss": "158244", "process_out_blocks": "3464", "process_in_blocks": "0"}
[0m13:21:40.690590 [debug] [MainThread]: Command `dbt run` succeeded at 13:21:40.690407 after 5.73 seconds
[0m13:21:40.691097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cc0b0a6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cc0dfeed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cc59aba50>]}
[0m13:21:40.691602 [debug] [MainThread]: Flushing usage events
[0m13:23:33.284680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbdf0bc750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbdeb17ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbdec90410>]}


============================== 13:23:33.289491 | 8545e923-edb4-4588-a1c5-5904f9aa3469 ==============================
[0m13:23:33.289491 [info ] [MainThread]: Running with dbt=1.7.1
[0m13:23:33.290248 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'cache_selected_only': 'False', 'invocation_command': 'dbt run --select path:models/report --profiles-dir /usr/local/airflow/include/dbt/', 'target_path': 'None', 'debug': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'log_format': 'default', 'log_path': '/usr/local/airflow/include/dbt/logs', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'version_check': 'True', 'no_print': 'None', 'use_experimental_parser': 'False', 'write_json': 'True', 'introspect': 'True', 'quiet': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'log_cache_events': 'False', 'static_parser': 'True', 'printer_width': '80', 'warn_error': 'None', 'indirect_selection': 'eager'}
[0m13:23:33.913935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8545e923-edb4-4588-a1c5-5904f9aa3469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbdcbceb50>]}
[0m13:23:34.028541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8545e923-edb4-4588-a1c5-5904f9aa3469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbde7f4710>]}
[0m13:23:34.029614 [info ] [MainThread]: Registered adapter: bigquery=1.7.1
[0m13:23:34.060596 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m13:23:34.100663 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:23:34.101646 [debug] [MainThread]: Partial parsing: updated file: pokemon://models/report/report_type_invoices.sql
[0m13:23:34.267336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8545e923-edb4-4588-a1c5-5904f9aa3469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbdc804ed0>]}
[0m13:23:34.281465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8545e923-edb4-4588-a1c5-5904f9aa3469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbdc8dda50>]}
[0m13:23:34.282237 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m13:23:34.282834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8545e923-edb4-4588-a1c5-5904f9aa3469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbdc834e90>]}
[0m13:23:34.284718 [info ] [MainThread]: 
[0m13:23:34.285957 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:23:34.287503 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_pokemon-403919'
[0m13:23:34.288248 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:23:35.008625 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pokemon-403919, now list_pokemon-403919_pokemon)
[0m13:23:35.009314 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:23:35.603398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8545e923-edb4-4588-a1c5-5904f9aa3469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbdc9dd710>]}
[0m13:23:35.604552 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:23:35.605118 [info ] [MainThread]: 
[0m13:23:35.613209 [debug] [Thread-1 (]: Began running node model.pokemon.report_type_invoices
[0m13:23:35.614414 [info ] [Thread-1 (]: 1 of 1 START sql table model pokemon.report_type_invoices ...................... [RUN]
[0m13:23:35.615778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pokemon-403919_pokemon, now model.pokemon.report_type_invoices)
[0m13:23:35.616434 [debug] [Thread-1 (]: Began compiling node model.pokemon.report_type_invoices
[0m13:23:35.625759 [debug] [Thread-1 (]: Writing injected SQL for node "model.pokemon.report_type_invoices"
[0m13:23:35.626671 [debug] [Thread-1 (]: Timing info for model.pokemon.report_type_invoices (compile): 13:23:35.616790 => 13:23:35.626380
[0m13:23:35.627187 [debug] [Thread-1 (]: Began executing node model.pokemon.report_type_invoices
[0m13:23:35.643464 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:23:36.289227 [debug] [Thread-1 (]: Writing runtime sql for node "model.pokemon.report_type_invoices"
[0m13:23:36.290090 [debug] [Thread-1 (]: On model.pokemon.report_type_invoices: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "pokemon", "target_name": "dev", "node_id": "model.pokemon.report_type_invoices"} */

  
    

    create or replace table `pokemon-403919`.`pokemon`.`report_type_invoices`
      
    
    

    OPTIONS()
    as (
      SELECT
    t.primary_type,
    t.secondary_type,
    COUNT(t.pokemon_id) AS full_type
FROM `pokemon-403919`.`pokemon`.`dim_type` t 
GROUP BY t.primary_type, t.secondary_type
ORDER BY full_type DESC
LIMIT 10
    );
  
[0m13:23:36.700990 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=pokemon-403919&j=bq:us-east1:adc7ffb2-02bb-4f4b-99bd-717c5406c485&page=queryresults
[0m13:23:38.481464 [debug] [Thread-1 (]: Timing info for model.pokemon.report_type_invoices (execute): 13:23:35.627502 => 13:23:38.481136
[0m13:23:38.482939 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8545e923-edb4-4588-a1c5-5904f9aa3469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbdc8a4410>]}
[0m13:23:38.484048 [info ] [Thread-1 (]: 1 of 1 OK created sql table model pokemon.report_type_invoices ................. [[32mCREATE TABLE (10.0 rows, 20.7 KiB processed)[0m in 2.87s]
[0m13:23:38.485197 [debug] [Thread-1 (]: Finished running node model.pokemon.report_type_invoices
[0m13:23:38.488024 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:23:38.488543 [debug] [MainThread]: Connection 'model.pokemon.report_type_invoices' was properly closed.
[0m13:23:38.489060 [info ] [MainThread]: 
[0m13:23:38.489624 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.20 seconds (4.20s).
[0m13:23:38.490783 [debug] [MainThread]: Command end result
[0m13:23:38.637561 [info ] [MainThread]: 
[0m13:23:38.638222 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:23:38.638842 [info ] [MainThread]: 
[0m13:23:38.639483 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:23:38.640609 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.400625, "process_user_time": 3.653387, "process_kernel_time": 0.330306, "process_mem_max_rss": "159788", "process_out_blocks": "3464", "process_in_blocks": "0"}
[0m13:23:38.641287 [debug] [MainThread]: Command `dbt run` succeeded at 13:23:38.641114 after 5.40 seconds
[0m13:23:38.641774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbdee3a850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbdee02a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbe3ad7b10>]}
[0m13:23:38.642309 [debug] [MainThread]: Flushing usage events
